
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../client_side_security_user_experience/">
      
      
        <link rel="next" href="../database_integration_sql_security/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Server-Side Programming, Authentication & Template Engines - Software Engineering - Stage 6 - NSW</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-YG16K7VJ8G"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-YG16K7VJ8G",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-YG16K7VJ8G",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#server-side-programming-authentication-template-engines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Software Engineering - Stage 6 - NSW" class="md-header__button md-logo" aria-label="Software Engineering - Stage 6 - NSW" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering - Stage 6 - NSW
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Server-Side Programming, Authentication & Template Engines
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mr-bev/software-engineering-stage6-nsw" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mr-bev/se-stage6-nsw
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
  
  <nav id="quiz-progress-mobile" class="quiz-progress-mobile md-nav" aria-label="Quiz Progress" style="display: none;">
    <!-- mkdocs-quiz progress sidebar (mobile) -->
    <div class="quiz-progress-bar">
      <div class="quiz-progress-bar-incorrect" style="width: 0%"></div>
      <div class="quiz-progress-bar-correct" style="width: 0%"></div>
    </div>
    <div data-md-component="quiz-progress">
        <div class="quiz-correct-reset">
          <span class="md-ellipsis">
            <span data-quiz-translate="Answered:">Answered:</span> <span class="quiz-progress-answered">0</span> / <span class="quiz-progress-total">0</span>
          </span>
          <span class="md-ellipsis">
            <span data-quiz-translate="Correct:">Correct:</span> <span class="quiz-progress-score">0</span> / <span class="quiz-progress-score-total">0</span>
          </span>
          <a href="#" class="quiz-reset-all-link" style="color: var(--md-primary-fg-color); text-decoration: none;">
            <span data-quiz-translate="Reset">Reset</span>
          </a>
        </div>
    </div>
  </nav>

  
  
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Syllabus/" class="md-tabs__link">
          
  
  
  Syllabus

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../principles/" class="md-tabs__link">
          
  
  
  Principles of SE

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../fundamentals/number_systems/" class="md-tabs__link">
          
  
  
  Software Fundamentals

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../object_oriented_software/" class="md-tabs__link">
          
  
  
  Object Oriented

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mechatronics/" class="md-tabs__link">
          
  
  
  Mechatronics

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Secure Web Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../machine_learning/" class="md-tabs__link">
          
  
  
  Machine Learning

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      

      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
  
  
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Software Engineering - Stage 6 - NSW" class="md-nav__button md-logo" aria-label="Software Engineering - Stage 6 - NSW" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering - Stage 6 - NSW
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mr-bev/software-engineering-stage6-nsw" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mr-bev/se-stage6-nsw
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Syllabus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Syllabus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/programming-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/object-oriented-paradigm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object Oriented Paradigm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/programming-mechatronics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming Mechatronics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/secure-software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Secure Software Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/web-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming For The Web
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/software-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Syllabus/se-project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Engineering Project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Principles of SE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Principles of SE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/sdlc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SDLC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/waterfall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Waterfall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/agile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/other_sdlc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Other Development Lifecycles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../principles/revision_control_systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Revision Control Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Software Fundamentals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software Fundamentals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/number_systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Number Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/data_structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Structures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/big_o/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Algorithm Complexity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/software_quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Quality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/asynch_and_threading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Async and Threading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Object Oriented
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Object Oriented
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../object_oriented_software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../object_oriented_software/key_concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../object_oriented_software/object_oriented_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object Oriented Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../object_oriented_software/software_design_patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Mechatronics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Mechatronics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/hardware_software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hardware and Software
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/sensors_actuators_effectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sensors, Actuators and End Effectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/design_engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design and Engineering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/system_integration_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Integration and Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/control_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechatronics/programming_building/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming and Building
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Secure Web Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Secure Web Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Web Fundamentals + Security Awareness
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Web Fundamentals + Security Awareness
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_the_web_works/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How the Web Works
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_protocols_security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Protocols & Security Foundations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_development_security_mindset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Development & Security Mindset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Front-End Development & Input Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Front-End Development & Input Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../javascript_fun_client_security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JavaScript Fundamentals & Client-Side Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../css_frameworks_version_control_secure_dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CSS Frameworks, Version Control & Secure Development Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client_side_security_user_experience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client-Side Security & User Experience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" checked>
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Back-End Development & Core Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Back-End Development & Core Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Server-Side Programming, Authentication & Template Engines
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Server-Side Programming, Authentication & Template Engines
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lesson-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lesson Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Outcomes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-understanding-server-side-web-programming-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: Understanding Server-Side Web Programming (15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Understanding Server-Side Web Programming (15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-the-request-response-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 The Request-Response Cycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-why-server-side-programming" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Why Server-Side Programming?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-check-your-understanding" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Check Your Understanding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-setting-up-your-first-web-server-20-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: Setting Up Your First Web Server (20 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Setting Up Your First Web Server (20 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-create-your-first-server-guided-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Create Your First Server (Guided Practice)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-understanding-routes-and-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Understanding Routes and Endpoints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-handling-different-http-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 Handling Different HTTP Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Handling Different HTTP Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-your-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test your change
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-practice-activity-create-your-own-routes" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 Practice Activity: Create Your Own Routes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-template-engines-dynamic-html-generation-20-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: Template Engines - Dynamic HTML Generation (20 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Template Engines - Dynamic HTML Generation (20 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-why-use-template-engines" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Why Use Template Engines?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-setting-up-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Setting Up Templates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-template-syntax-essentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Template Syntax Essentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-practice-activity-create-a-user-profile-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Practice Activity: Create a User Profile Template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-cryptography-secure-authentication-35-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 4: Cryptography &amp; Secure Authentication (35 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 4: Cryptography &amp; Secure Authentication (35 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-understanding-password-hashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Understanding Password Hashing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-why-hashing-alone-isnt-enough" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Why Hashing Alone Isn't Enough
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-password-hashing-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Password Hashing Algorithms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-implementing-secure-authentication-guided-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Implementing Secure Authentication (Guided Practice)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-building-a-complete-authentication-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Building a Complete Authentication System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-understanding-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.6 Understanding Sessions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-practice-activity-test-the-authentication-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.7 Practice Activity: Test the Authentication System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-5-security-best-practices-code-review-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 5: Security Best Practices &amp; Code Review (15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 5: Security Best Practices &amp; Code Review (15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-defensive-data-input-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Defensive Data Input Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-common-web-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Common Web Vulnerabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-security-testing-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Security Testing Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-practice-activity-security-code-review" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Practice Activity: Security Code Review
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-6-bringing-it-all-together-10-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 6: Bringing It All Together (10-15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 6: Bringing It All Together (10-15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-complete-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Complete Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-final-comprehensive-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Final Comprehensive Challenge
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assessment-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assessment &amp; Next Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assessment &amp; Next Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-assessment-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Self-Assessment Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quiz" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quiz
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extension-activities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extension Activities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Resources
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syllabus-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Syllabus Alignment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teacher-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Teacher Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Teacher Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Troubleshooting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database_integration_sql_security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Integration & SQL Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced_auth_session_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Authentication, Authorisation & Session Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file_security_safe_apis_cryptography/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Security, Safe APIs & Cryptography in Practice
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Secure Architecture & Progressive Web Apps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Secure Architecture & Progressive Web Apps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pwa_privacy_by_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Progressive Web Apps & Privacy by Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing_strategies_security_hardening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Strategies & Security Hardening
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../business_continuity_disaster_recovery_open_source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Business Continuity, Disaster Recovery & Open Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../collaborative_development_professional_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaborative Development & Professional Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Enterprise Impact & Professional Standards
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Enterprise Impact & Professional Standards
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise_benefits_industry_imp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enterprise Benefits & Industry Impact
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../social_ethical_legal_ram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Social, Ethical & Legal Ramifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Machine Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/foundations_of_ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Foundations of AI, ML & Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/ml_training_models_data_fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML Training Models & Data Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/classical_ml_algorithms_concepts_simple_implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classical ML Algorithms - Concepts & Simple Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/regression_models_linear_polynomial_implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression Models - Linear & Polynomial Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/logistic_regression_model_comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logistic Regression & Model Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/neural_networks_simplified_introduction_advanced_class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neural Networks - Simplified Introduction & Advanced Classical ML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/human_factors_behavior_bias_ml_ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Human Factors, Behaviour Patterns & Bias in ML/AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine_learning/impact_assessment_synthesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Impact Assessment & Synthesis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lesson-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lesson Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Outcomes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-understanding-server-side-web-programming-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: Understanding Server-Side Web Programming (15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Understanding Server-Side Web Programming (15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-the-request-response-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 The Request-Response Cycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-why-server-side-programming" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Why Server-Side Programming?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-check-your-understanding" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Check Your Understanding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-setting-up-your-first-web-server-20-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: Setting Up Your First Web Server (20 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Setting Up Your First Web Server (20 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-create-your-first-server-guided-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Create Your First Server (Guided Practice)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-understanding-routes-and-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Understanding Routes and Endpoints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-handling-different-http-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 Handling Different HTTP Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Handling Different HTTP Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-your-change" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test your change
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-practice-activity-create-your-own-routes" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 Practice Activity: Create Your Own Routes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-template-engines-dynamic-html-generation-20-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: Template Engines - Dynamic HTML Generation (20 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Template Engines - Dynamic HTML Generation (20 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-why-use-template-engines" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Why Use Template Engines?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-setting-up-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Setting Up Templates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-template-syntax-essentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Template Syntax Essentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-practice-activity-create-a-user-profile-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Practice Activity: Create a User Profile Template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-cryptography-secure-authentication-35-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 4: Cryptography &amp; Secure Authentication (35 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 4: Cryptography &amp; Secure Authentication (35 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-understanding-password-hashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Understanding Password Hashing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-why-hashing-alone-isnt-enough" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Why Hashing Alone Isn't Enough
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-password-hashing-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Password Hashing Algorithms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-implementing-secure-authentication-guided-practice" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Implementing Secure Authentication (Guided Practice)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-building-a-complete-authentication-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Building a Complete Authentication System
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-understanding-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.6 Understanding Sessions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-practice-activity-test-the-authentication-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.7 Practice Activity: Test the Authentication System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-5-security-best-practices-code-review-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 5: Security Best Practices &amp; Code Review (15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 5: Security Best Practices &amp; Code Review (15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-defensive-data-input-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Defensive Data Input Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-common-web-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Common Web Vulnerabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-security-testing-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Security Testing Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-practice-activity-security-code-review" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Practice Activity: Security Code Review
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-6-bringing-it-all-together-10-15-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 6: Bringing It All Together (10-15 minutes)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 6: Bringing It All Together (10-15 minutes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-complete-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Complete Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-final-comprehensive-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Final Comprehensive Challenge
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assessment-next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assessment &amp; Next Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assessment &amp; Next Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-assessment-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Self-Assessment Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quiz" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quiz
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extension-activities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extension Activities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Resources
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syllabus-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Syllabus Alignment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teacher-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Teacher Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Teacher Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Troubleshooting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          

  
  <div id="quiz-progress-sidebar" aria-label="Quiz Progress" style="display: none;">
    <!-- mkdocs-quiz progress sidebar (desktop) -->
    <label class="md-nav__title">
      <span class="md-nav__icon md-icon"></span>
      <span data-quiz-translate="Quiz Progress">Quiz Progress</span>
    </label>
    <ul class="md-nav__list" data-md-component="quiz-progress">
      <li class="md-nav__item">
        <div class="md-nav__link">
          <span class="md-ellipsis">
            <span data-quiz-translate="Answered:">Answered:</span> <span class="quiz-progress-answered">0</span> / <span class="quiz-progress-total">0</span> (<span class="quiz-progress-answered-percentage">0%</span>)
          </span>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link">
          <div class="quiz-progress-bar">
            <div class="quiz-progress-bar-incorrect" style="width: 0%"></div>
            <div class="quiz-progress-bar-correct" style="width: 0%"></div>
          </div>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link quiz-correct-reset">
          <span class="md-ellipsis">
            <span data-quiz-translate="Correct:">Correct:</span> <span class="quiz-progress-score">0</span> / <span class="quiz-progress-score-total">0</span> (<span class="quiz-progress-score-percentage">0%</span>)
          </span>
          <a href="#" class="quiz-reset-all-link" style="color: var(--md-primary-fg-color); text-decoration: none;">
            <span data-quiz-translate="Reset">Reset</span>
          </a>
        </div>
      </li>
    </ul>
  </div>

          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="server-side-programming-authentication-template-engines">Server-Side Programming, Authentication &amp; Template Engines</h1>
<h2 id="lesson-overview">Lesson Overview</h2>
<p><strong>Duration:</strong> 90-120 minutes (self-paced)<br />
<strong>Level:</strong> Intermediate web development<br />
<strong>Prerequisites:</strong> Basic HTML, CSS, JavaScript, and command line familiarity</p>
<hr />
<h2 id="learning-outcomes">Learning Outcomes</h2>
<p>By the end of this lesson, you will be able to:</p>
<ol>
<li><strong>Remember &amp; Understand:</strong> Explain how web servers process requests and the role of server-side programming</li>
<li><strong>Apply:</strong> Set up a web server and create routes to handle HTTP requests</li>
<li><strong>Apply:</strong> Implement template engines to render dynamic HTML content</li>
<li><strong>Analyse:</strong> Compare secure vs insecure authentication practices</li>
<li><strong>Create:</strong> Build a complete authentication system with password hashing</li>
<li><strong>Evaluate:</strong> Test and review code for security vulnerabilities</li>
</ol>
<hr />
<h2 id="required-setup">Required Setup</h2>
<p>Before starting, ensure you have:</p>
<ul>
<li><strong>Python 3.8+</strong> installed (check with <code>python --version</code> or <code>python3 --version</code>)</li>
<li><strong>Text editor</strong> (VS Code, Sublime Text, or similar)</li>
<li><strong>Terminal/Command Prompt</strong> access</li>
<li><strong>Web browser</strong> with developer tools</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Important Setup Note</p>
<p>This lesson uses Python and Flask. If you prefer Node.js/Express, the concepts remain identicalonly the syntax differs. Focus on understanding the principles rather than memorising specific code.</p>
</div>
<hr />
<h2 id="part-1-understanding-server-side-web-programming-15-minutes">Part 1: Understanding Server-Side Web Programming (15 minutes)</h2>
<h3 id="11-the-request-response-cycle">1.1 The Request-Response Cycle</h3>
<p>When you visit a website, here's what happens:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Browser as Browser (Client)
    participant Server as Web Server
    participant Database as Database

    Browser-&gt;&gt;Server: 1. HTTP Request (GET /products)
    Note over Server: 2. Process request&lt;br/&gt;- Route to handler&lt;br/&gt;- Run business logic
    Server-&gt;&gt;Database: 3. Query data if needed
    Database--&gt;&gt;Server: 4. Return data
    Note over Server: 5. Generate response&lt;br/&gt;- Render template&lt;br/&gt;- Apply security
    Server--&gt;&gt;Browser: 6. HTTP Response (HTML)
    Note over Browser: 7. Render page&lt;br/&gt;- Display HTML&lt;br/&gt;- Execute CSS/JS</code></pre>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>Client-side (Front-end):</strong> What runs in the user's browser (HTML, CSS, JavaScript)</li>
<li><strong>Server-side (Back-end):</strong> What runs on the web server (Python, Node.js, PHP, etc.)</li>
<li><strong>Web Server Software:</strong> Apache, Nginx, or built-in servers (handles HTTP requests)</li>
<li><strong>Web Framework:</strong> Express, Flask, Django (simplifies building web applications)</li>
</ul>
<h3 id="12-why-server-side-programming">1.2 Why Server-Side Programming?</h3>
<p>Server-side code allows you to:</p>
<ul>
<li><strong>Process sensitive data</strong> (passwords, payments) securely</li>
<li><strong>Access databases</strong> to store and retrieve information</li>
<li><strong>Generate dynamic content</strong> based on user input or data</li>
<li><strong>Implement authentication</strong> and authorisation</li>
<li><strong>Control business logic</strong> that shouldn't be exposed to clients</li>
</ul>
<pre class="mermaid"><code>graph TB
    subgraph "Client-Side (Browser)"
        A[HTML/CSS/JS]
        B[User Interface]
        C[Client Validation]
    end

    subgraph "Server-Side (Secure)"
        D[Authentication]
        E[Business Logic]
        F[Database Access]
        G[Server Validation]
    end

    subgraph "Why Server-Side?"
        H[ Security: Hide sensitive code]
        I[ Data: Access databases safely]
        J[ Validation: Enforce rules]
        K[ Auth: Control access]
    end

    A --&gt; D
    B --&gt; E
    C --&gt; G

    D --&gt; H
    E --&gt; I
    F --&gt; I
    G --&gt; J
    D --&gt; K</code></pre>
<div class="admonition tip">
<p class="admonition-title">Real-World Example</p>
<p>When you log into a website, the server checks your password, creates a session, and decides what content you're allowed to see. This cannot happen on the client-side because users could manipulate the code!</p>
</div>
<h3 id="13-check-your-understanding">1.3 Check Your Understanding</h3>
<p><strong>Question 1:</strong> Why can't password verification happen entirely on the client-side (in the browser)?</p>
<details>
<summary>Click to reveal answer</summary>
<p>Because client-side code can be viewed and modified by anyone using browser developer tools. If password checking happened in JavaScript, a malicious user could bypass it or steal password hashes. Server-side code is hidden and secure.</p>
</details>
<p><strong>Question 2:</strong> Match the component to its role:</p>
<ul>
<li>Apache/Nginx  [ ]</li>
<li>Flask/Express  [ ]</li>
<li>HTML/CSS  [ ]</li>
<li>Database  [ ]</li>
</ul>
<p>Options: A) Web framework, B) Webserver software, C) Client-side presentation, D) Data storage</p>
<details>
<summary>Click to reveal answer</summary>
<ul>
<li>Apache/Nginx  <strong>B</strong> (Webserver software)</li>
<li>Flask/Express  <strong>A</strong> (Web framework)</li>
<li>HTML/CSS  <strong>C</strong> (Client-side presentation)</li>
<li>Database  <strong>D</strong> (Data storage)</li>
</ul>
</details>
<hr />
<h2 id="part-2-setting-up-your-first-web-server-20-minutes">Part 2: Setting Up Your First Web Server (20 minutes)</h2>
<h3 id="21-installation">2.1 Installation</h3>
<p>Open your terminal and install Flask:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Create a project directory</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>mkdir<span class="w"> </span>week7-server
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">cd</span><span class="w"> </span>week7-server
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Install Flask (Python web framework)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>pip<span class="w"> </span>install<span class="w"> </span>flask
</code></pre></div>
<h3 id="22-create-your-first-server-guided-practice">2.2 Create Your First Server (Guided Practice)</h3>
<p>Create a file called <code>app.py</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Import the Flask framework and related functions</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template_string</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Create a Flask application instance</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># Define a route - this handles requests to the home page &quot;/&quot;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="sd">    This function runs when someone visits http://localhost:5000/</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="sd">    Returns HTML content to display</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="s2">    &lt;html&gt;</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="s2">        &lt;head&gt;&lt;title&gt;My First Server&lt;/title&gt;&lt;/head&gt;</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="s2">        &lt;body&gt;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="s2">            &lt;h1&gt;Hello from the Server!&lt;/h1&gt;</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="s2">            &lt;p&gt;This HTML was generated by Python code running on the server.&lt;/p&gt;</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="s2">        &lt;/body&gt;</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="s2">    &lt;/html&gt;</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c1"># Define another route for an about page</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/about&#39;</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="k">def</span><span class="w"> </span><span class="nf">about</span><span class="p">():</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    <span class="k">return</span> <span class="s2">&quot;&lt;h1&gt;About Page&lt;/h1&gt;&lt;p&gt;This is a different route!&lt;/p&gt;&quot;</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="c1"># Start the server when this file is run</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div>
<p><strong>Run your server:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>python<span class="w"> </span>app.py
</code></pre></div>
<p>Open your browser and visit: <code>http://localhost:5000</code></p>
<div class="admonition success">
<p class="admonition-title">You've Created a Web Server!</p>
<p>Your computer is now acting as a web server! The Flask framework is listening for HTTP requests on port 5000.</p>
</div>
<h3 id="23-understanding-routes-and-endpoints">2.3 Understanding Routes and Endpoints</h3>
<pre class="mermaid"><code>graph LR
    A[Browser Request] --&gt; B{Server Router}
    B --&gt;|GET /| C[home function]
    B --&gt;|GET /about| D[about function]
    B --&gt;|GET /contact| E[contact function]
    B --&gt;|POST /contact| F[process_contact function]

    C --&gt; G[Return HTML]
    D --&gt; G
    E --&gt; G
    F --&gt; G

    G --&gt; H[Send to Browser]

    style B fill:#f9f,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Routes</strong> are URL paths that your server responds to:</p>
<ul>
<li><code>@app.route('/')</code>  Handles <code>http://localhost:5000/</code></li>
<li><code>@app.route('/about')</code>  Handles <code>http://localhost:5000/about</code></li>
<li><code>@app.route('/users/profile')</code>  Handles <code>http://localhost:5000/users/profile</code></li>
</ul>
<h3 id="24-handling-different-http-methods">2.4 Handling Different HTTP Methods</h3>
<p>Add this to your <code>app.py</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/contact&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">contact</span><span class="p">():</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="sd">    This route handles both GET and POST requests</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="sd">    GET: Display the contact form</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="sd">    POST: Process the submitted form data</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="c1"># Access form data sent from the client</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>        <span class="n">email</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="c1"># SERVER-SIDE VALIDATION (critical for security!)</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">email</span><span class="p">:</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>            <span class="k">return</span> <span class="s2">&quot;Error: Name and email are required!&quot;</span><span class="p">,</span> <span class="mi">400</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>        <span class="c1"># Process the data (would normally save to database)</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;h1&gt;Thank you, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&lt;/h1&gt;&lt;p&gt;We&#39;ll contact you at </span><span class="si">{</span><span class="n">email</span><span class="si">}</span><span class="s2">&lt;/p&gt;&quot;</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>    <span class="c1"># GET request - show the form</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="s2">    &lt;html&gt;</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="s2">        &lt;body&gt;</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="s2">            &lt;h1&gt;Contact Us&lt;/h1&gt;</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="s2">            &lt;form method=&quot;POST&quot;&gt;</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="s2">                &lt;label&gt;Name: &lt;input type=&quot;text&quot; name=&quot;name&quot; required&gt;&lt;/label&gt;&lt;br&gt;</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="s2">                &lt;label&gt;Email: &lt;input type=&quot;email&quot; name=&quot;email&quot; required&gt;&lt;/label&gt;&lt;br&gt;</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="s2">                &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="s2">            &lt;/form&gt;</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="s2">        &lt;/body&gt;</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="s2">    &lt;/html&gt;</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div>
<h4 id="test-your-change">Test your change</h4>
<ul>
<li>The link below will test your change by calling your server-side code.</li>
<li>hover over the link to verify that it is not doing anything malicious<ul>
<li>try typing in good and bad data to see how validation works</li>
</ul>
</li>
<li><a _target="_target" href="http://localhost:5000/contact">http://localhost:5000/contact</a></li>
<li>ensure that you put it above the following code if you get a Not Found error. Also double check the port number is the one you are using
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Start the server when this file is run</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Critical Security Concept</p>
<p><strong>ALWAYS validate and sanitise data on the server</strong>, even if you have client-side validation. Users can bypass HTML form validation using browser tools or direct HTTP requests.</p>
</div>
<h3 id="25-practice-activity-create-your-own-routes">2.5 Practice Activity: Create Your Own Routes</h3>
<p><strong>Task:</strong> Add the following routes to your <code>app.py</code>:</p>
<ol>
<li><code>/products</code> - displays a list of 3 products (hardcoded for now)</li>
<li><code>/search</code> - accepts a GET parameter <code>?query=</code> and displays the search term</li>
<li>Example: <code>/search?query=laptops</code> should display "Searching for: laptops"</li>
</ol>
<details>
<summary>Click for solution</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/products&#39;</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">products</span><span class="p">():</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="s2">    &lt;h1&gt;Our Products&lt;/h1&gt;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="s2">    &lt;ul&gt;</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="s2">        &lt;li&gt;Laptop - $999&lt;/li&gt;</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="s2">        &lt;li&gt;Mouse - $25&lt;/li&gt;</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="s2">        &lt;li&gt;Keyboard - $75&lt;/li&gt;</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="s2">    &lt;/ul&gt;</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">():</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="c1"># Get the &#39;query&#39; parameter from the URL</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;query&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="c1"># Input validation</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        <span class="k">return</span> <span class="s2">&quot;Please provide a search query&quot;</span><span class="p">,</span> <span class="mi">400</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="c1"># Sanitise to prevent XSS (basic example)</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">markupsafe</span><span class="w"> </span><span class="kn">import</span> <span class="n">escape</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="n">safe_query</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;h1&gt;Searching for: </span><span class="si">{</span><span class="n">safe_query</span><span class="si">}</span><span class="s2">&lt;/h1&gt;&quot;</span>
</code></pre></div>
</details>
<hr />
<h2 id="part-3-template-engines-dynamic-html-generation-20-minutes">Part 3: Template Engines - Dynamic HTML Generation (20 minutes)</h2>
<h3 id="31-why-use-template-engines">3.1 Why Use Template Engines?</h3>
<p>So far, we've been writing HTML inside Python strings. This becomes messy for large pages. <strong>Template engines</strong> let us:</p>
<ul>
<li>Separate HTML structure from Python logic</li>
<li>Inject dynamic data into HTML templates</li>
<li>Reuse common HTML components (headers, footers)</li>
<li>Write cleaner, more maintainable code</li>
</ul>
<pre class="mermaid"><code>flowchart TD
    subgraph "Without Templates (Messy)"
        direction TB
        A[Python Code] --&gt;|HTML strings mixed in| B[Hard to maintain]
        B --&gt; C[No code reuse]
        C --&gt; D[Difficult for designers]
    end

    subgraph "With Templates (Clean)"
        direction TB
        E[Python Code] --&gt;|Pass data| F[Template Engine]
        G[HTML Templates] --&gt;|Structure| F
        F --&gt; H[Rendered HTML]
        H --&gt; I[Easy to maintain]
        I --&gt; J[Reusable components]
        J --&gt; K[Designer-friendly]
    end

    style F fill:#90EE90,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Popular Template Engines:</strong></p>
<ul>
<li><strong>Jinja2</strong> (Python/Flask) - what we'll use</li>
<li><strong>EJS</strong> (Node.js/Express)</li>
<li><strong>Handlebars</strong> (JavaScript)</li>
</ul>
<h3 id="32-setting-up-templates">3.2 Setting Up Templates</h3>
<p>Create a folder structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>week7-server/
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a> app.py
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a> templates/
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>     base.html
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>     home.html
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>     user_profile.html
</code></pre></div>
<p><strong>Create <code>templates/base.html</code></strong> (reusable layout):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{% block title %}My Website{% endblock %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">        </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span><span class="w"> </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="nt">nav</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#333</span><span class="p">;</span><span class="w"> </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nt">nav</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span><span class="w"> </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">        </span><span class="p">.</span><span class="nc">container</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>    <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/about&quot;</span><span class="p">&gt;</span>About<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/profile&quot;</span><span class="p">&gt;</span>Profile<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>        {% block content %}
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>        <span class="cm">&lt;!-- Child templates will inject content here --&gt;</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>        {% endblock %}
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p><strong>Create <code>templates/home.html</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>{% block title %}Home - My Website{% endblock %}
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>{% block content %}
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome, {{ username }}!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>The current time is: {{ current_time }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Recent Activity:<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>    {% for activity in activities %}
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ activity }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>    {% endfor %}
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>{% endblock %}
</code></pre></div>
<p><strong>Update <code>app.py</code> to use templates:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>    <span class="c1"># Prepare data to send to the template</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;Student&#39;</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        <span class="s1">&#39;current_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">),</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>            <span class="s1">&#39;Completed Week 6 assignment&#39;</span><span class="p">,</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>            <span class="s1">&#39;Started server-side programming&#39;</span><span class="p">,</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>            <span class="s1">&#39;Built first web server&#39;</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>        <span class="p">]</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>    <span class="p">}</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>    <span class="c1"># Render the template with the data</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;home.html&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div>
<h3 id="33-template-syntax-essentials">3.3 Template Syntax Essentials</h3>
<pre class="mermaid"><code>graph LR
    A[Python Data] --&gt;|username='Alex'| B[Template Engine]
    C[HTML Template] --&gt;|"{{ username }}"| B
    B --&gt; D[Rendered: Alex]

    E[Python List] --&gt;|"activities=[...]"| F[Template Engine]
    G[HTML Template] --&gt;|"{% for item %}"| F
    F --&gt; H[Rendered List Items]

    style B fill:#FFE5B4,stroke:#333,stroke-width:2px
    style F fill:#FFE5B4,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Jinja2 syntax:</strong></p>
<ul>
<li><code>{{ variable }}</code> - Output a variable's value</li>
<li><code>{% for item in list %}...{% endfor %}</code> - Loop through items</li>
<li><code>{% if condition %}...{% endif %}</code> - Conditional logic</li>
<li><code>{% extends "base.html" %}</code> - Inherit from another template</li>
<li><code>{% block name %}...{% endblock %}</code> - Define/override content blocks</li>
</ul>
<h3 id="34-practice-activity-create-a-user-profile-template">3.4 Practice Activity: Create a User Profile Template</h3>
<p><strong>Task:</strong> Create <code>templates/user_profile.html</code> that displays:</p>
<ul>
<li>User's name, email, and account age</li>
<li>A list of their skills</li>
<li>A conditional message: "Premium Member" if they are premium, otherwise "Free Account"</li>
</ul>
<p>Then create a route <code>/profile</code> that renders this template with sample data.</p>
<details>
<summary>Click for solution</summary>
<p><strong>templates/user_profile.html:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>{% block title %}User Profile{% endblock %}
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>{% block content %}
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ user.name }}&#39;s Profile<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    {% if user.is_premium %}
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;badge&quot;</span><span class="p">&gt;</span> Premium Member<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    {% else %}
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;badge&quot;</span><span class="p">&gt;</span>Free Account<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    {% endif %}
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;profile-info&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Email:<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ user.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Member since:<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ user.account_age }} days<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Skills:<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>    {% for skill in user.skills %}
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ skill }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>    {% endfor %}
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>{% endblock %}
</code></pre></div>
<p><strong>In app.py:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">profile</span><span class="p">():</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">user_data</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Alex Smith&#39;</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;alex@example.com&#39;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>            <span class="s1">&#39;account_age&#39;</span><span class="p">:</span> <span class="mi">127</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>            <span class="s1">&#39;is_premium&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>            <span class="s1">&#39;skills&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;Web Security&#39;</span><span class="p">]</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>        <span class="p">}</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="p">}</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;user_profile.html&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">user_data</span><span class="p">)</span>
</code></pre></div>
</details>
<hr />
<h2 id="part-4-cryptography-secure-authentication-35-minutes">Part 4: Cryptography &amp; Secure Authentication (35 minutes)</h2>
<div class="admonition danger">
<p class="admonition-title">Critical Security Concept</p>
<p><strong>NEVER store passwords in plain text!</strong> This is one of the most serious security vulnerabilities. If your database is breached, all user passwords would be exposed.</p>
</div>
<h3 id="41-understanding-password-hashing">4.1 Understanding Password Hashing</h3>
<pre class="mermaid"><code>graph TB
    subgraph "Plain Text Storage (NEVER DO THIS)"
        direction TB
        A1[User Password:&lt;br/&gt;'mypassword123'] --&gt; B1[Database]
        B1 --&gt; C1[ Stored as:&lt;br/&gt;'mypassword123']
        D1[Hacker breaches DB] --&gt; C1
        C1 --&gt; E1[ All passwords exposed!]
    end

    subgraph "Hashed Storage (CORRECT)"
        direction TB
        A2[User Password:&lt;br/&gt;'mypassword123'] --&gt; F[Hash Function&lt;br/&gt;bcrypt]
        F --&gt; G[Database]
        G --&gt; H[ Stored as:&lt;br/&gt;'$2b$12$KIx...' hash]
        I[Hacker breaches DB] --&gt; H
        H --&gt; J[ Cannot reverse hash&lt;br/&gt;Passwords safe!]
    end

    style E1 fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style J fill:#ccffcc,stroke:#00cc00,stroke-width:2px</code></pre>
<p><strong>Hashing</strong> is a one-way cryptographic function:</p>
<ul>
<li>Takes any input (password)  produces fixed-length output (hash)</li>
<li><strong>Irreversible:</strong> Cannot convert hash back to original password</li>
<li><strong>Deterministic:</strong> Same input always produces same hash</li>
<li><strong>Avalanche effect:</strong> Tiny change in input drastically changes hash</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>Password: &quot;mysecret123&quot;
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>SHA-256 Hash: &quot;8d4f1c5...&quot; (64 characters)
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Password: &quot;mysecret124&quot; (changed one character!)
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>SHA-256 Hash: &quot;f2a9b7e...&quot; (completely different hash)
</code></pre></div>
<h3 id="42-why-hashing-alone-isnt-enough">4.2 Why Hashing Alone Isn't Enough</h3>
<pre class="mermaid"><code>graph TB
    subgraph "Solution: Salting"
        direction TB
        G[Password:&lt;br/&gt;'password123'] --&gt; H[+ Random Salt:&lt;br/&gt;'a7f3x9q2']
        H --&gt; I[Hash Combined:&lt;br/&gt;hash'password123a7f3x9q2']
        I --&gt; J[Unique Hash:&lt;br/&gt;'9e4d1b...']
        K[Rainbow Table] -.-&gt;|No match!| J
        J --&gt; L[ Password protected]
    end

    subgraph "Problem: Rainbow Tables"
        direction TB
        A[Common Password:&lt;br/&gt;'password123'] --&gt; B[Known Hash:&lt;br/&gt;'482c811...']
        C[Attacker has&lt;br/&gt;Rainbow Table] --&gt; D[Precomputed&lt;br/&gt;millions of hashes]
        E[Hacker finds match] --&gt; B
        B --&gt; F[ Password cracked!]
    end

    style F fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style L fill:#ccffcc,stroke:#00cc00,stroke-width:2px</code></pre>
<p><strong>Problem:</strong> Rainbow tables (precomputed hashes of common passwords)</p>
<p><strong>Solution: Salting</strong></p>
<ul>
<li>Add random data (salt) to each password before hashing</li>
<li>Same password  different hash for each user</li>
<li>Makes rainbow table attacks impractical</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>User 1: hash(&quot;password123&quot; + &quot;random_salt_1&quot;)  &quot;a7f3c2...&quot;
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>User 2: hash(&quot;password123&quot; + &quot;random_salt_2&quot;)  &quot;9e4d1b...&quot;
</code></pre></div>
<h3 id="43-password-hashing-algorithms">4.3 Password Hashing Algorithms</h3>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Security Level</th>
<th>Speed</th>
<th>Recommendation</th>
</tr>
</thead>
<tbody>
<tr>
<td>MD5</td>
<td> Broken</td>
<td>Very Fast</td>
<td>Never use</td>
</tr>
<tr>
<td>SHA-256</td>
<td> Not ideal for passwords</td>
<td>Fast</td>
<td>Use for data integrity, not passwords</td>
</tr>
<tr>
<td><strong>bcrypt</strong></td>
<td> Excellent</td>
<td>Slow (good!)</td>
<td><strong>Recommended</strong></td>
</tr>
<tr>
<td><strong>scrypt</strong></td>
<td> Excellent</td>
<td>Slow (good!)</td>
<td><strong>Recommended</strong></td>
</tr>
<tr>
<td><strong>Argon2</strong></td>
<td> Best</td>
<td>Slow (good!)</td>
<td><strong>Recommended</strong> (newest)</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Why "Slow" is Good for Passwords</p>
<p>Password hashing should be intentionally slow (adjustable) to make brute-force attacks expensive and time-consuming. Bcrypt, scrypt, and Argon2 include a "cost factor" that controls computational difficulty.</p>
</div>
<h3 id="44-implementing-secure-authentication-guided-practice">4.4 Implementing Secure Authentication (Guided Practice)</h3>
<p>Install the bcrypt library:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>pip<span class="w"> </span>install<span class="w"> </span>bcrypt
</code></pre></div>
<p><strong>Create <code>auth.py</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">hash_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="sd">    Hash a password using bcrypt with automatic salting.</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="sd">        password (str): Plain text password</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="sd">    Returns:</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="sd">        bytes: Hashed password (includes salt)</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>    <span class="c1"># Convert string to bytes</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>    <span class="n">password_bytes</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>    <span class="c1"># Generate salt and hash (cost factor = 12)</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>    <span class="c1"># Higher cost = more secure but slower</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>    <span class="n">salt</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>    <span class="n">hashed</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password_bytes</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>    <span class="k">return</span> <span class="n">hashed</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">hashed_password</span><span class="p">):</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="sd">    Verify a password against a stored hash.</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="sd">        password (str): Plain text password to check</span>
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="sd">        hashed_password (bytes): Stored hashed password</span>
<a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a>
<a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="sd">    Returns:</span>
<a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="sd">        bool: True if password matches, False otherwise</span>
<a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a>    <span class="n">password_bytes</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>    <span class="k">return</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password_bytes</span><span class="p">,</span> <span class="n">hashed_password</span><span class="p">)</span>
<a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a>
<a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a><span class="c1"># Example usage:</span>
<a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a>    <span class="c1"># Simulate user registration</span>
<a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a>    <span class="n">user_password</span> <span class="o">=</span> <span class="s2">&quot;SuperSecret123!&quot;</span>
<a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a>    <span class="n">hashed</span> <span class="o">=</span> <span class="n">hash_password</span><span class="p">(</span><span class="n">user_password</span><span class="p">)</span>
<a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stored in database: </span><span class="si">{</span><span class="n">hashed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a>
<a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a>    <span class="c1"># Simulate user login</span>
<a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a>    <span class="n">login_attempt</span> <span class="o">=</span> <span class="s2">&quot;SuperSecret123!&quot;</span>
<a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a>    <span class="k">if</span> <span class="n">verify_password</span><span class="p">(</span><span class="n">login_attempt</span><span class="p">,</span> <span class="n">hashed</span><span class="p">):</span>
<a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Login successful!&quot;</span><span class="p">)</span>
<a id="__codelineno-15-48" name="__codelineno-15-48" href="#__codelineno-15-48"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-49" name="__codelineno-15-49" href="#__codelineno-15-49"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Invalid password!&quot;</span><span class="p">)</span>
<a id="__codelineno-15-50" name="__codelineno-15-50" href="#__codelineno-15-50"></a>
<a id="__codelineno-15-51" name="__codelineno-15-51" href="#__codelineno-15-51"></a>    <span class="c1"># Try wrong password</span>
<a id="__codelineno-15-52" name="__codelineno-15-52" href="#__codelineno-15-52"></a>    <span class="n">wrong_attempt</span> <span class="o">=</span> <span class="s2">&quot;WrongPassword&quot;</span>
<a id="__codelineno-15-53" name="__codelineno-15-53" href="#__codelineno-15-53"></a>    <span class="k">if</span> <span class="n">verify_password</span><span class="p">(</span><span class="n">wrong_attempt</span><span class="p">,</span> <span class="n">hashed</span><span class="p">):</span>
<a id="__codelineno-15-54" name="__codelineno-15-54" href="#__codelineno-15-54"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Login successful!&quot;</span><span class="p">)</span>
<a id="__codelineno-15-55" name="__codelineno-15-55" href="#__codelineno-15-55"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-15-56" name="__codelineno-15-56" href="#__codelineno-15-56"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Invalid password!&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Run it:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>python<span class="w"> </span>auth.py
</code></pre></div>
<h3 id="45-building-a-complete-authentication-system">4.5 Building a Complete Authentication System</h3>
<pre class="mermaid"><code>sequenceDiagram
    participant U as User
    participant B as Browser
    participant S as Server
    participant DB as Database

    Note over U,DB: Registration Flow
    U-&gt;&gt;B: Enter username, email, password
    B-&gt;&gt;S: POST /register
    Note over S: 1. Validate inputs&lt;br/&gt;2. Check username available
    S-&gt;&gt;S: Hash password with bcrypt
    S-&gt;&gt;DB: Store username, email, hash
    DB--&gt;&gt;S: Success
    S--&gt;&gt;B: Registration successful

    Note over U,DB: Login Flow
    U-&gt;&gt;B: Enter username, password
    B-&gt;&gt;S: POST /login
    S-&gt;&gt;DB: Query user by username
    DB--&gt;&gt;S: Return stored hash
    Note over S: Verify password against hash
    alt Password correct
        S-&gt;&gt;S: Create session
        S--&gt;&gt;B: Set session cookie
        B--&gt;&gt;U: Redirect to dashboard
    else Password incorrect
        S--&gt;&gt;B: Invalid credentials
        B--&gt;&gt;U: Show error
    end</code></pre>
<p><strong>Create <code>templates/register.html</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>{% block title %}Register{% endblock %}
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>{% block content %}
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Create an Account<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    {% if error %}
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: red; padding: 10px; background: #ffebee; margin-bottom: 10px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>            {{ error }}
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>    {% endif %}
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>    {% if success %}
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: green; padding: 10px; background: #e8f5e9; margin-bottom: 10px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>            {{ success }}
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>    {% endif %}
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/register&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">&gt;</span>Username:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">required</span> 
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>                   <span class="na">minlength</span><span class="o">=</span><span class="s">&quot;3&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;20&quot;</span> 
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>                   <span class="na">pattern</span><span class="o">=</span><span class="s">&quot;[a-zA-Z0-9_]+&quot;</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>                   <span class="na">title</span><span class="o">=</span><span class="s">&quot;Letters, numbers, and underscores only&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;email&quot;</span><span class="p">&gt;</span>Email:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>Password:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">required</span>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>                   <span class="na">minlength</span><span class="o">=</span><span class="s">&quot;8&quot;</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>                   <span class="na">title</span><span class="o">=</span><span class="s">&quot;At least 8 characters&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>            <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>Minimum 8 characters<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;confirm_password&quot;</span><span class="p">&gt;</span>Confirm Password:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;confirm_password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;confirm_password&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Register<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a>
<a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Already have an account? <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/login&quot;</span><span class="p">&gt;</span>Login here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-17-51" name="__codelineno-17-51" href="#__codelineno-17-51"></a>{% endblock %}
</code></pre></div>
<p><strong>Create <code>templates/login.html</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>{% block title %}Login{% endblock %}
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>{% block content %}
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    {% if error %}
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: red; padding: 10px; background: #ffebee; margin-bottom: 10px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>            {{ error }}
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>    {% endif %}
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/login&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">&gt;</span>Username:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>Password:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Don&#39;t have an account? <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/register&quot;</span><span class="p">&gt;</span>Register here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>{% endblock %}
</code></pre></div>
<p><strong>Update <code>app.py</code> with authentication:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">session</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s1">&#39;your-secret-key-change-this-in-production&#39;</span>  <span class="c1"># Needed for sessions</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1"># Simulated database (in real app, use actual database)</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">users_db</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="c1"># Import password hashing functions</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">hash_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    <span class="n">password_bytes</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    <span class="n">salt</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>    <span class="k">return</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password_bytes</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">hashed_password</span><span class="p">):</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>    <span class="n">password_bytes</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    <span class="k">return</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password_bytes</span><span class="p">,</span> <span class="n">hashed_password</span><span class="p">)</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="c1"># Input validation functions</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_username</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="sd">    Validate username: 3-20 characters, alphanumeric and underscores only</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9_]+$&#39;</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a>
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_email</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a><span class="sd">    Basic email validation</span>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>    <span class="n">email_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;</span>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a>    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">email_pattern</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a><span class="sd">    Password must be at least 8 characters</span>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a><span class="sd">    For better security, add complexity requirements</span>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">password</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a>    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a>
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/register&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a><span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">():</span>
<a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-19-51" name="__codelineno-19-51" href="#__codelineno-19-51"></a>        <span class="c1"># Get form data</span>
<a id="__codelineno-19-52" name="__codelineno-19-52" href="#__codelineno-19-52"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-19-53" name="__codelineno-19-53" href="#__codelineno-19-53"></a>        <span class="n">email</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-19-54" name="__codelineno-19-54" href="#__codelineno-19-54"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-19-55" name="__codelineno-19-55" href="#__codelineno-19-55"></a>        <span class="n">confirm_password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confirm_password&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-19-56" name="__codelineno-19-56" href="#__codelineno-19-56"></a>
<a id="__codelineno-19-57" name="__codelineno-19-57" href="#__codelineno-19-57"></a>        <span class="c1"># SERVER-SIDE VALIDATION (critical!)</span>
<a id="__codelineno-19-58" name="__codelineno-19-58" href="#__codelineno-19-58"></a>        <span class="c1"># Never trust client-side validation alone</span>
<a id="__codelineno-19-59" name="__codelineno-19-59" href="#__codelineno-19-59"></a>
<a id="__codelineno-19-60" name="__codelineno-19-60" href="#__codelineno-19-60"></a>        <span class="c1"># Validate username</span>
<a id="__codelineno-19-61" name="__codelineno-19-61" href="#__codelineno-19-61"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validate_username</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
<a id="__codelineno-19-62" name="__codelineno-19-62" href="#__codelineno-19-62"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-63" name="__codelineno-19-63" href="#__codelineno-19-63"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Username must be 3-20 characters, letters/numbers/underscores only&#39;</span><span class="p">)</span>
<a id="__codelineno-19-64" name="__codelineno-19-64" href="#__codelineno-19-64"></a>
<a id="__codelineno-19-65" name="__codelineno-19-65" href="#__codelineno-19-65"></a>        <span class="c1"># Check if username exists</span>
<a id="__codelineno-19-66" name="__codelineno-19-66" href="#__codelineno-19-66"></a>        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="n">users_db</span><span class="p">:</span>
<a id="__codelineno-19-67" name="__codelineno-19-67" href="#__codelineno-19-67"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-68" name="__codelineno-19-68" href="#__codelineno-19-68"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Username already exists&#39;</span><span class="p">)</span>
<a id="__codelineno-19-69" name="__codelineno-19-69" href="#__codelineno-19-69"></a>
<a id="__codelineno-19-70" name="__codelineno-19-70" href="#__codelineno-19-70"></a>        <span class="c1"># Validate email</span>
<a id="__codelineno-19-71" name="__codelineno-19-71" href="#__codelineno-19-71"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validate_email</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
<a id="__codelineno-19-72" name="__codelineno-19-72" href="#__codelineno-19-72"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-73" name="__codelineno-19-73" href="#__codelineno-19-73"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Invalid email address&#39;</span><span class="p">)</span>
<a id="__codelineno-19-74" name="__codelineno-19-74" href="#__codelineno-19-74"></a>
<a id="__codelineno-19-75" name="__codelineno-19-75" href="#__codelineno-19-75"></a>        <span class="c1"># Validate password</span>
<a id="__codelineno-19-76" name="__codelineno-19-76" href="#__codelineno-19-76"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">validate_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
<a id="__codelineno-19-77" name="__codelineno-19-77" href="#__codelineno-19-77"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-78" name="__codelineno-19-78" href="#__codelineno-19-78"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Password must be at least 8 characters&#39;</span><span class="p">)</span>
<a id="__codelineno-19-79" name="__codelineno-19-79" href="#__codelineno-19-79"></a>
<a id="__codelineno-19-80" name="__codelineno-19-80" href="#__codelineno-19-80"></a>        <span class="c1"># Check password confirmation</span>
<a id="__codelineno-19-81" name="__codelineno-19-81" href="#__codelineno-19-81"></a>        <span class="k">if</span> <span class="n">password</span> <span class="o">!=</span> <span class="n">confirm_password</span><span class="p">:</span>
<a id="__codelineno-19-82" name="__codelineno-19-82" href="#__codelineno-19-82"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-83" name="__codelineno-19-83" href="#__codelineno-19-83"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Passwords do not match&#39;</span><span class="p">)</span>
<a id="__codelineno-19-84" name="__codelineno-19-84" href="#__codelineno-19-84"></a>
<a id="__codelineno-19-85" name="__codelineno-19-85" href="#__codelineno-19-85"></a>        <span class="c1"># HASH THE PASSWORD (never store plain text!)</span>
<a id="__codelineno-19-86" name="__codelineno-19-86" href="#__codelineno-19-86"></a>        <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">hash_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-19-87" name="__codelineno-19-87" href="#__codelineno-19-87"></a>
<a id="__codelineno-19-88" name="__codelineno-19-88" href="#__codelineno-19-88"></a>        <span class="c1"># Store user in database (simulated)</span>
<a id="__codelineno-19-89" name="__codelineno-19-89" href="#__codelineno-19-89"></a>        <span class="n">users_db</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-90" name="__codelineno-19-90" href="#__codelineno-19-90"></a>            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
<a id="__codelineno-19-91" name="__codelineno-19-91" href="#__codelineno-19-91"></a>            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">hashed_password</span>
<a id="__codelineno-19-92" name="__codelineno-19-92" href="#__codelineno-19-92"></a>        <span class="p">}</span>
<a id="__codelineno-19-93" name="__codelineno-19-93" href="#__codelineno-19-93"></a>
<a id="__codelineno-19-94" name="__codelineno-19-94" href="#__codelineno-19-94"></a>        <span class="c1"># Success - redirect to login</span>
<a id="__codelineno-19-95" name="__codelineno-19-95" href="#__codelineno-19-95"></a>        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-96" name="__codelineno-19-96" href="#__codelineno-19-96"></a>            <span class="n">success</span><span class="o">=</span><span class="s1">&#39;Account created successfully! Please login.&#39;</span><span class="p">)</span>
<a id="__codelineno-19-97" name="__codelineno-19-97" href="#__codelineno-19-97"></a>
<a id="__codelineno-19-98" name="__codelineno-19-98" href="#__codelineno-19-98"></a>    <span class="c1"># GET request - show registration form</span>
<a id="__codelineno-19-99" name="__codelineno-19-99" href="#__codelineno-19-99"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">)</span>
<a id="__codelineno-19-100" name="__codelineno-19-100" href="#__codelineno-19-100"></a>
<a id="__codelineno-19-101" name="__codelineno-19-101" href="#__codelineno-19-101"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-19-102" name="__codelineno-19-102" href="#__codelineno-19-102"></a><span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
<a id="__codelineno-19-103" name="__codelineno-19-103" href="#__codelineno-19-103"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-19-104" name="__codelineno-19-104" href="#__codelineno-19-104"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-19-105" name="__codelineno-19-105" href="#__codelineno-19-105"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-19-106" name="__codelineno-19-106" href="#__codelineno-19-106"></a>
<a id="__codelineno-19-107" name="__codelineno-19-107" href="#__codelineno-19-107"></a>        <span class="c1"># Input validation</span>
<a id="__codelineno-19-108" name="__codelineno-19-108" href="#__codelineno-19-108"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
<a id="__codelineno-19-109" name="__codelineno-19-109" href="#__codelineno-19-109"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-110" name="__codelineno-19-110" href="#__codelineno-19-110"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Username and password are required&#39;</span><span class="p">)</span>
<a id="__codelineno-19-111" name="__codelineno-19-111" href="#__codelineno-19-111"></a>
<a id="__codelineno-19-112" name="__codelineno-19-112" href="#__codelineno-19-112"></a>        <span class="c1"># Check if user exists</span>
<a id="__codelineno-19-113" name="__codelineno-19-113" href="#__codelineno-19-113"></a>        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">users_db</span><span class="p">:</span>
<a id="__codelineno-19-114" name="__codelineno-19-114" href="#__codelineno-19-114"></a>            <span class="c1"># Don&#39;t reveal whether username exists (security best practice)</span>
<a id="__codelineno-19-115" name="__codelineno-19-115" href="#__codelineno-19-115"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-116" name="__codelineno-19-116" href="#__codelineno-19-116"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Invalid username or password&#39;</span><span class="p">)</span>
<a id="__codelineno-19-117" name="__codelineno-19-117" href="#__codelineno-19-117"></a>
<a id="__codelineno-19-118" name="__codelineno-19-118" href="#__codelineno-19-118"></a>        <span class="c1"># Verify password</span>
<a id="__codelineno-19-119" name="__codelineno-19-119" href="#__codelineno-19-119"></a>        <span class="n">stored_hash</span> <span class="o">=</span> <span class="n">users_db</span><span class="p">[</span><span class="n">username</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
<a id="__codelineno-19-120" name="__codelineno-19-120" href="#__codelineno-19-120"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">verify_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">stored_hash</span><span class="p">):</span>
<a id="__codelineno-19-121" name="__codelineno-19-121" href="#__codelineno-19-121"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-19-122" name="__codelineno-19-122" href="#__codelineno-19-122"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Invalid username or password&#39;</span><span class="p">)</span>
<a id="__codelineno-19-123" name="__codelineno-19-123" href="#__codelineno-19-123"></a>
<a id="__codelineno-19-124" name="__codelineno-19-124" href="#__codelineno-19-124"></a>        <span class="c1"># SUCCESS - Create session</span>
<a id="__codelineno-19-125" name="__codelineno-19-125" href="#__codelineno-19-125"></a>        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
<a id="__codelineno-19-126" name="__codelineno-19-126" href="#__codelineno-19-126"></a>        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;logged_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-19-127" name="__codelineno-19-127" href="#__codelineno-19-127"></a>
<a id="__codelineno-19-128" name="__codelineno-19-128" href="#__codelineno-19-128"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;dashboard&#39;</span><span class="p">))</span>
<a id="__codelineno-19-129" name="__codelineno-19-129" href="#__codelineno-19-129"></a>
<a id="__codelineno-19-130" name="__codelineno-19-130" href="#__codelineno-19-130"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
<a id="__codelineno-19-131" name="__codelineno-19-131" href="#__codelineno-19-131"></a>
<a id="__codelineno-19-132" name="__codelineno-19-132" href="#__codelineno-19-132"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span>
<a id="__codelineno-19-133" name="__codelineno-19-133" href="#__codelineno-19-133"></a><span class="k">def</span><span class="w"> </span><span class="nf">dashboard</span><span class="p">():</span>
<a id="__codelineno-19-134" name="__codelineno-19-134" href="#__codelineno-19-134"></a>    <span class="c1"># Check if user is logged in</span>
<a id="__codelineno-19-135" name="__codelineno-19-135" href="#__codelineno-19-135"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logged_in&#39;</span><span class="p">):</span>
<a id="__codelineno-19-136" name="__codelineno-19-136" href="#__codelineno-19-136"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
<a id="__codelineno-19-137" name="__codelineno-19-137" href="#__codelineno-19-137"></a>
<a id="__codelineno-19-138" name="__codelineno-19-138" href="#__codelineno-19-138"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-19-139" name="__codelineno-19-139" href="#__codelineno-19-139"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-19-140" name="__codelineno-19-140" href="#__codelineno-19-140"></a><span class="s2">    &lt;html&gt;</span>
<a id="__codelineno-19-141" name="__codelineno-19-141" href="#__codelineno-19-141"></a><span class="s2">        &lt;body&gt;</span>
<a id="__codelineno-19-142" name="__codelineno-19-142" href="#__codelineno-19-142"></a><span class="s2">            &lt;h1&gt;Welcome to your dashboard, </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">!&lt;/h1&gt;</span>
<a id="__codelineno-19-143" name="__codelineno-19-143" href="#__codelineno-19-143"></a><span class="s2">            &lt;p&gt;You are successfully logged in.&lt;/p&gt;</span>
<a id="__codelineno-19-144" name="__codelineno-19-144" href="#__codelineno-19-144"></a><span class="s2">            &lt;a href=&quot;/logout&quot;&gt;Logout&lt;/a&gt;</span>
<a id="__codelineno-19-145" name="__codelineno-19-145" href="#__codelineno-19-145"></a><span class="s2">        &lt;/body&gt;</span>
<a id="__codelineno-19-146" name="__codelineno-19-146" href="#__codelineno-19-146"></a><span class="s2">    &lt;/html&gt;</span>
<a id="__codelineno-19-147" name="__codelineno-19-147" href="#__codelineno-19-147"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-148" name="__codelineno-19-148" href="#__codelineno-19-148"></a>
<a id="__codelineno-19-149" name="__codelineno-19-149" href="#__codelineno-19-149"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">)</span>
<a id="__codelineno-19-150" name="__codelineno-19-150" href="#__codelineno-19-150"></a><span class="k">def</span><span class="w"> </span><span class="nf">logout</span><span class="p">():</span>
<a id="__codelineno-19-151" name="__codelineno-19-151" href="#__codelineno-19-151"></a>    <span class="c1"># Clear the session</span>
<a id="__codelineno-19-152" name="__codelineno-19-152" href="#__codelineno-19-152"></a>    <span class="n">session</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-19-153" name="__codelineno-19-153" href="#__codelineno-19-153"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
<a id="__codelineno-19-154" name="__codelineno-19-154" href="#__codelineno-19-154"></a>
<a id="__codelineno-19-155" name="__codelineno-19-155" href="#__codelineno-19-155"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<a id="__codelineno-19-156" name="__codelineno-19-156" href="#__codelineno-19-156"></a><span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
<a id="__codelineno-19-157" name="__codelineno-19-157" href="#__codelineno-19-157"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-19-158" name="__codelineno-19-158" href="#__codelineno-19-158"></a><span class="s2">    &lt;html&gt;</span>
<a id="__codelineno-19-159" name="__codelineno-19-159" href="#__codelineno-19-159"></a><span class="s2">        &lt;body&gt;</span>
<a id="__codelineno-19-160" name="__codelineno-19-160" href="#__codelineno-19-160"></a><span class="s2">            &lt;h1&gt;Authentication Demo&lt;/h1&gt;</span>
<a id="__codelineno-19-161" name="__codelineno-19-161" href="#__codelineno-19-161"></a><span class="s2">            &lt;ul&gt;</span>
<a id="__codelineno-19-162" name="__codelineno-19-162" href="#__codelineno-19-162"></a><span class="s2">                &lt;li&gt;&lt;a href=&quot;/register&quot;&gt;Register&lt;/a&gt;&lt;/li&gt;</span>
<a id="__codelineno-19-163" name="__codelineno-19-163" href="#__codelineno-19-163"></a><span class="s2">                &lt;li&gt;&lt;a href=&quot;/login&quot;&gt;Login&lt;/a&gt;&lt;/li&gt;</span>
<a id="__codelineno-19-164" name="__codelineno-19-164" href="#__codelineno-19-164"></a><span class="s2">            &lt;/ul&gt;</span>
<a id="__codelineno-19-165" name="__codelineno-19-165" href="#__codelineno-19-165"></a><span class="s2">        &lt;/body&gt;</span>
<a id="__codelineno-19-166" name="__codelineno-19-166" href="#__codelineno-19-166"></a><span class="s2">    &lt;/html&gt;</span>
<a id="__codelineno-19-167" name="__codelineno-19-167" href="#__codelineno-19-167"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-168" name="__codelineno-19-168" href="#__codelineno-19-168"></a>
<a id="__codelineno-19-169" name="__codelineno-19-169" href="#__codelineno-19-169"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-19-170" name="__codelineno-19-170" href="#__codelineno-19-170"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div>
<h3 id="46-understanding-sessions">4.6 Understanding Sessions</h3>
<pre class="mermaid"><code>sequenceDiagram
    participant B as Browser
    participant S as Server
    participant M as Session Store

    Note over B,M: User Logs In
    B-&gt;&gt;S: POST /login (credentials)
    S-&gt;&gt;S: Verify password
    S-&gt;&gt;M: Create session data
    M--&gt;&gt;S: Return session_id: "abc123"
    S--&gt;&gt;B: Set-Cookie: session=abc123

    Note over B,M: Subsequent Requests
    B-&gt;&gt;S: GET /dashboard&lt;br/&gt;Cookie: session=abc123
    S-&gt;&gt;M: Lookup session "abc123"
    M--&gt;&gt;S: Return user data
    S--&gt;&gt;B: Protected content

    Note over B,M: User Logs Out
    B-&gt;&gt;S: GET /logout&lt;br/&gt;Cookie: session=abc123
    S-&gt;&gt;M: Delete session "abc123"
    M--&gt;&gt;S: Deleted
    S--&gt;&gt;B: Clear-Cookie</code></pre>
<p><strong>Sessions</strong> allow the server to remember users across multiple requests:</p>
<ol>
<li>User logs in successfully</li>
<li>Server creates a session ID and stores it (in memory or database)</li>
<li>Server sends session ID to browser (stored in cookie)</li>
<li>Browser includes session ID in subsequent requests</li>
<li>Server validates session ID to identify the user</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Session Security</p>
<ul>
<li>Always use HTTPS in production (encrypts session cookies)</li>
<li>Set session timeout (expire inactive sessions)</li>
<li>Regenerate session ID after login (prevents session fixation attacks)</li>
<li>Use secure, httpOnly, and sameSite cookie flags</li>
</ul>
</div>
<h3 id="47-practice-activity-test-the-authentication-system">4.7 Practice Activity: Test the Authentication System</h3>
<p><strong>Tasks:</strong></p>
<ol>
<li>
<p>Start your server and test the complete flow:</p>
<ul>
<li>Register a new account</li>
<li>Try to register with the same username (should fail)</li>
<li>Login with correct credentials</li>
<li>Try to access <code>/dashboard</code> without logging in (should redirect)</li>
<li>Logout</li>
</ul>
</li>
<li>
<p><strong>Security Testing:</strong></p>
<ul>
<li>Try SQL injection in username: <code>admin' OR '1'='1</code></li>
<li>Try XSS in username: <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code></li>
<li>Use browser dev tools to examine the session cookie</li>
<li>Try accessing <code>/dashboard</code> after deleting the session cookie</li>
</ul>
</li>
<li>
<p><strong>Code Review:</strong></p>
<ul>
<li>Identify all input validation points</li>
<li>Verify passwords are never logged or displayed</li>
<li>Check that error messages don't reveal too much information</li>
</ul>
</li>
</ol>
<hr />
<h2 id="part-5-security-best-practices-code-review-15-minutes">Part 5: Security Best Practices &amp; Code Review (15 minutes)</h2>
<h3 id="51-defensive-data-input-handling">5.1 Defensive Data Input Handling</h3>
<div class="admonition danger">
<p class="admonition-title">Never Trust User Input</p>
<p><strong>ALL user input is potentially malicious</strong> until proven otherwise. This includes form data, URL parameters, cookies, and file uploads.</p>
</div>
<pre class="mermaid"><code>graph TB
    A[User Input] --&gt; B{1. Validation}
    B --&gt;|Invalid| C[Return Error]
    B --&gt;|Valid| D{2. Sanitisation}
    D --&gt; E[Remove/Escape&lt;br/&gt;Dangerous Characters]
    E --&gt; F{3. Error Handling}
    F --&gt;|Safe| G[Process Data]
    F --&gt;|Unsafe| H[Log &amp; Return&lt;br/&gt;Generic Error]

    style B fill:#FFE5B4,stroke:#333,stroke-width:2px
    style D fill:#FFE5B4,stroke:#333,stroke-width:2px
    style F fill:#FFE5B4,stroke:#333,stroke-width:2px
    style G fill:#90EE90,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Three-Layer Defence:</strong></p>
<ol>
<li><strong>Validation:</strong> Check if input meets expected format/criteria</li>
<li><strong>Sanitisation:</strong> Clean input by removing/escaping dangerous characters</li>
<li><strong>Error Handling:</strong> Gracefully handle invalid input without revealing sensitive info</li>
</ol>
<p><strong>Example of comprehensive input handling:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">markupsafe</span><span class="w"> </span><span class="kn">import</span> <span class="n">escape</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/comment&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">submit_comment</span><span class="p">():</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="n">comment</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>    <span class="c1"># 1. VALIDATION</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">comment</span><span class="p">:</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>        <span class="k">return</span> <span class="s2">&quot;Comment cannot be empty&quot;</span><span class="p">,</span> <span class="mi">400</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>        <span class="k">return</span> <span class="s2">&quot;Comment too long (max 500 characters)&quot;</span><span class="p">,</span> <span class="mi">400</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="c1"># Check for suspicious patterns</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;script|javascript:|onerror=&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>        <span class="k">return</span> <span class="s2">&quot;Invalid comment content&quot;</span><span class="p">,</span> <span class="mi">400</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>    <span class="c1"># 2. SANITISATION</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>    <span class="c1"># Escape HTML to prevent XSS</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>    <span class="n">safe_comment</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>    <span class="c1"># 3. ERROR HANDLING (shown above)</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>    <span class="c1"># Return appropriate error codes, don&#39;t expose system details</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>    <span class="c1"># Store the sanitised comment</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>    <span class="c1"># database.save(safe_comment)</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Comment saved: </span><span class="si">{</span><span class="n">safe_comment</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<h3 id="52-common-web-vulnerabilities">5.2 Common Web Vulnerabilities</h3>
<pre class="mermaid"><code>mindmap
  root((Web Security&lt;br/&gt;Vulnerabilities))
    Authentication
      Broken Auth
      Weak Passwords
      Session Hijacking
      No MFA
    Injection
      SQL Injection
      XSS
      Command Injection
      LDAP Injection
    Data Protection
      Plain Text Passwords
      Weak Encryption
      Exposed Secrets
      No HTTPS
    Access Control
      Broken Authorisation
      IDOR
      Path Traversal
      CSRF</code></pre>
<table>
<thead>
<tr>
<th>Vulnerability</th>
<th>Description</th>
<th>Prevention</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Broken Authentication</strong></td>
<td>Weak password policies, session management flaws</td>
<td>Use bcrypt/argon2, implement session timeout, secure cookies</td>
</tr>
<tr>
<td><strong>XSS (Cross-Site Scripting)</strong></td>
<td>Injecting malicious scripts into web pages</td>
<td>Sanitise all output, use Content Security Policy headers</td>
</tr>
<tr>
<td><strong>CSRF (Cross-Site Request Forgery)</strong></td>
<td>Forcing users to execute unwanted actions</td>
<td>Use CSRF tokens in forms, verify origin headers</td>
</tr>
<tr>
<td><strong>SQL Injection</strong></td>
<td>Manipulating database queries</td>
<td>Use parameterised queries/ORMs, never concatenate SQL</td>
</tr>
<tr>
<td><strong>Session Hijacking</strong></td>
<td>Stealing session cookies</td>
<td>HTTPS only, httpOnly cookies, regenerate session IDs</td>
</tr>
</tbody>
</table>
<h3 id="53-security-testing-checklist">5.3 Security Testing Checklist</h3>
<p>Use this checklist to review your authentication code:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Passwords are hashed with bcrypt/scrypt/argon2</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> No passwords stored in plain text anywhere (including logs!)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Password has minimum length requirement (8+ characters)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> All user inputs are validated on the server</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Special characters in inputs are escaped/sanitised</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Error messages don't reveal whether username exists</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Sessions expire after inactivity</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Session IDs are regenerated after login</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> SQL queries use parameterisation (not string concatenation)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> HTTPS is used in production (not HTTP)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Rate limiting prevents brute force attacks</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> File uploads are validated (type, size, content)</li>
</ul>
<h3 id="54-practice-activity-security-code-review">5.4 Practice Activity: Security Code Review</h3>
<p><strong>Review this code and identify the security vulnerabilities:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login_bad&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">login_bad</span><span class="p">():</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="c1"># Query database (VULNERABLE!)</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE username=&#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password=&#39;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> logged in with password </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># VULNERABLE!</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Welcome </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">!&quot;</span>  <span class="c1"># VULNERABLE!</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;No user found with username </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># VULNERABLE!</span>
</code></pre></div>
<details>
<summary>Click to reveal vulnerabilities</summary>

<pre class="mermaid"><code>graph TB
    A[Vulnerable Code] --&gt; B[1. SQL Injection]
    A --&gt; C[2. Plain Text Passwords]
    A --&gt; D[3. XSS Vulnerability]
    A --&gt; E[4. Information Disclosure]
    A --&gt; F[5. No Input Validation]

    B --&gt; B1[String concatenation&lt;br/&gt;in SQL query]
    C --&gt; C1[Passwords stored&lt;br/&gt;in plain text]
    C --&gt; C2[Passwords logged&lt;br/&gt;to console]
    D --&gt; D1[Username inserted&lt;br/&gt;without escaping]
    E --&gt; E1[Error reveals if&lt;br/&gt;username exists]
    F --&gt; F1[No checks on&lt;br/&gt;format or length]

    style A fill:#ffcccc,stroke:#cc0000,stroke-width:3px
    style B fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style C fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style D fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style E fill:#ffcccc,stroke:#cc0000,stroke-width:2px
    style F fill:#ffcccc,stroke:#cc0000,stroke-width:2px</code></pre>

**Vulnerabilities identified:**

1. **SQL Injection:** Query uses string concatenation instead of parameterised queries
   - Attack: username = `admin' --` would bypass authentication

2. **Passwords in Plain Text:** 
   - Stored in database as plain text
   - Logged to console (security breach!)

3. **XSS Vulnerability:** Username is inserted into HTML without escaping
   - Attack: username = `<scrip>alert('XSS')</scrip>`
   - **Note:** script is spelt wrong on purpose as mkdocs-material will try to execute the script

4. **Information Disclosure:** Error message reveals whether username exists
   - Helps attackers enumerate valid usernames

5. **No Input Validation:** No checks on username or password format

**Fixed version:**

<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login_secure&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">login_secure</span><span class="p">():</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>    <span class="c1"># Validation</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>        <span class="k">return</span> <span class="s2">&quot;Invalid credentials&quot;</span><span class="p">,</span> <span class="mi">401</span>  <span class="c1"># Generic message</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>    <span class="c1"># Parameterised query (prevents SQL injection)</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT password_hash FROM users WHERE username = ?&quot;</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="n">username</span><span class="p">,))</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>    <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">verify_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;password_hash&#39;</span><span class="p">]):</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>        <span class="c1"># Never log passwords!</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>        <span class="c1"># logger.info(f&quot;Successful login for user {username}&quot;)</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>        <span class="n">safe_username</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>  <span class="c1"># Prevent XSS</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Welcome </span><span class="si">{</span><span class="n">safe_username</span><span class="si">}</span><span class="s2">!&quot;</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>        <span class="c1"># Generic error (doesn&#39;t reveal if username exists)</span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>        <span class="k">return</span> <span class="s2">&quot;Invalid credentials&quot;</span><span class="p">,</span> <span class="mi">401</span>
</code></pre></div>

</details>

<hr />
<h2 id="part-6-bringing-it-all-together-10-15-minutes">Part 6: Bringing It All Together (10-15 minutes)</h2>
<h3 id="61-complete-architecture-overview">6.1 Complete Architecture Overview</h3>
<p>Let's review how all the pieces work together:</p>
<pre class="mermaid"><code>graph TB
    subgraph "CLIENT LAYER (Browser)"
        A[HTML/CSS Rendering]
        B[JavaScript Execution]
        C[Session Cookie Storage]
    end

    subgraph "WEB SERVER LAYER (Flask/Express)"
        D[1. Routing System]
        E[2. Input Validation]
        F[3. Authentication Logic]
        G[4. Session Management]
        H[5. Template Engine]
    end

    subgraph "DATA LAYER"
        I[Database]
        J[Session Store]
    end

    A --&gt;|HTTP Request| D
    D --&gt; E
    E --&gt; F
    F --&gt; I
    F --&gt; G
    G --&gt; J
    H --&gt;|Rendered HTML| A

    style D fill:#FFE5B4,stroke:#333,stroke-width:2px
    style E fill:#FFB6C1,stroke:#333,stroke-width:2px
    style F fill:#98FB98,stroke:#333,stroke-width:2px
    style G fill:#87CEEB,stroke:#333,stroke-width:2px
    style H fill:#DDA0DD,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Complete Request Flow:</strong></p>
<pre class="mermaid"><code>sequenceDiagram
    autonumber
    participant U as User
    participant B as Browser
    participant R as Router
    participant V as Validator
    participant A as Auth Logic
    participant DB as Database
    participant T as Template Engine

    U-&gt;&gt;B: Submit login form
    B-&gt;&gt;R: POST /login (username, password)
    R-&gt;&gt;V: Validate inputs
    alt Invalid input
        V--&gt;&gt;B: 400 Bad Request
    else Valid input
        V-&gt;&gt;A: Check credentials
        A-&gt;&gt;DB: Query user by username
        DB--&gt;&gt;A: Return password hash
        A-&gt;&gt;A: Verify password
        alt Correct password
            A-&gt;&gt;A: Create session
            A-&gt;&gt;T: Render dashboard template
            T--&gt;&gt;B: HTML + Set session cookie
            B--&gt;&gt;U: Display dashboard
        else Incorrect password
            A--&gt;&gt;B: 401 Unauthorised
            B--&gt;&gt;U: Show error
        end
    end</code></pre>
<h3 id="62-final-comprehensive-challenge">6.2 Final Comprehensive Challenge</h3>
<p><strong>Build a Mini Blog System</strong></p>
<p>Create a complete application with:</p>
<p><strong>Requirements:</strong></p>
<ol>
<li><strong>User Registration &amp; Login</strong> (already complete from Part 4)</li>
<li><strong>Blog Post Creation:</strong> Authenticated users can create posts<ul>
<li>Title (required, max 100 chars)</li>
<li>Content (required, max 5000 chars)</li>
<li>Created timestamp</li>
</ul>
</li>
<li><strong>View All Posts:</strong> Anyone can view all posts (no login required)</li>
<li><strong>Security Requirements:</strong><ul>
<li>All inputs validated and sanitised</li>
<li>Posts associated with user who created them</li>
<li>Only post author can delete their posts</li>
<li>XSS protection on post content</li>
</ul>
</li>
</ol>
<pre class="mermaid"><code>graph TB
    A[User Action] --&gt; B{Logged In?}
    B --&gt;|No| C[View Posts Only]
    B --&gt;|Yes| D[Can Create Posts]
    D --&gt; E[Can Delete Own Posts]

    C --&gt; F[Public Access]
    D --&gt; G[Protected Access]
    E --&gt; G

    F --&gt; H[Read Operations]
    G --&gt; I[Write Operations]
    G --&gt; J[Delete Operations]

    style B fill:#FFE5B4,stroke:#333,stroke-width:2px
    style G fill:#98FB98,stroke:#333,stroke-width:2px</code></pre>
<p><strong>Starter Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Add to your existing app.py</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts&#39;</span><span class="p">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">view_posts</span><span class="p">():</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Display all blog posts&quot;&quot;&quot;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="c1"># TODO: Fetch posts from database</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="c1"># TODO: Render template with posts</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    <span class="k">pass</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts/create&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_post</span><span class="p">():</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new blog post (requires login)&quot;&quot;&quot;</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>    <span class="c1"># TODO: Check if user is logged in</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>    <span class="c1"># TODO: Validate title and content</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>    <span class="c1"># TODO: Sanitise inputs</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>    <span class="c1"># TODO: Save to database</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>    <span class="c1"># TODO: Associate with current user</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>    <span class="k">pass</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts/delete/&lt;int:post_id&gt;&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_post</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a post (only by author)&quot;&quot;&quot;</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>    <span class="c1"># TODO: Check if user is logged in</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>    <span class="c1"># TODO: Verify user owns this post</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>    <span class="c1"># TODO: Delete from database</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>    <span class="k">pass</span>
</code></pre></div>
<p><strong>Try it yourself first</strong>, then check the solution below.</p>
<details>
<summary>Click for complete solution</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">markupsafe</span><span class="w"> </span><span class="kn">import</span> <span class="n">escape</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1"># Add to global variables</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="n">posts_db</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Simulated database</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="n">post_id_counter</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="c1"># Add these routes to app.py</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts&#39;</span><span class="p">)</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">view_posts</span><span class="p">():</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Display all blog posts&quot;&quot;&quot;</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;posts.html&#39;</span><span class="p">,</span> <span class="n">posts</span><span class="o">=</span><span class="n">posts_db</span><span class="p">)</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts/create&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_post</span><span class="p">():</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>    <span class="c1"># Check authentication</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logged_in&#39;</span><span class="p">):</span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>        <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>        <span class="c1"># Validation</span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;create_post.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Title required (max 100 characters)&#39;</span><span class="p">)</span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">content</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;create_post.html&#39;</span><span class="p">,</span> 
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>                <span class="n">error</span><span class="o">=</span><span class="s1">&#39;Content required (max 5000 characters)&#39;</span><span class="p">)</span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>        <span class="c1"># Sanitise</span>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>        <span class="n">safe_title</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>        <span class="n">safe_content</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>        <span class="c1"># Create post</span>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>        <span class="k">global</span> <span class="n">post_id_counter</span>
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>        <span class="n">post</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">post_id_counter</span><span class="p">,</span>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">safe_title</span><span class="p">,</span>
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">safe_content</span><span class="p">,</span>
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>            <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">),</span>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a>        <span class="p">}</span>
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a>        <span class="n">posts_db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a>        <span class="n">post_id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;view_posts&#39;</span><span class="p">))</span>
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a>
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;create_post.html&#39;</span><span class="p">)</span>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a>
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/posts/delete/&lt;int:post_id&gt;&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_post</span><span class="p">(</span><span class="n">post_id</span><span class="p">):</span>
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a>    <span class="c1"># Check authentication</span>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logged_in&#39;</span><span class="p">):</span>
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a>        <span class="k">return</span> <span class="s2">&quot;Unauthorised&quot;</span><span class="p">,</span> <span class="mi">401</span>
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a>    <span class="c1"># Find post</span>
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a>    <span class="n">post</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">posts_db</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">post_id</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a>
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">post</span><span class="p">:</span>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>        <span class="k">return</span> <span class="s2">&quot;Post not found&quot;</span><span class="p">,</span> <span class="mi">404</span>
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a>
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a>    <span class="c1"># Check authorisation (only author can delete)</span>
<a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a>    <span class="k">if</span> <span class="n">post</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">):</span>
<a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a>        <span class="k">return</span> <span class="s2">&quot;Forbidden - you can only delete your own posts&quot;</span><span class="p">,</span> <span class="mi">403</span>
<a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a>
<a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a>    <span class="c1"># Delete post</span>
<a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a>    <span class="n">posts_db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
<a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a>
<a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;view_posts&#39;</span><span class="p">))</span>
</code></pre></div>
<p><strong>templates/posts.html:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>{% block title %}Blog Posts{% endblock %}
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>{% block content %}
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>All Blog Posts<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>    {% if session.logged_in %}
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/posts/create&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display: inline-block; margin-bottom: 20px; </span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="s">                                        padding: 10px 15px; background: #007bff; </span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="s">                                        color: white; text-decoration: none; border-radius: 4px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>            Create New Post
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>    {% endif %}
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>    {% if posts %}
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>        {% for post in posts %}
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>        <span class="p">&lt;</span><span class="nt">article</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;border: 1px solid #ddd; padding: 20px; margin-bottom: 20px; border-radius: 4px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>            <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ post.title }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>            <span class="p">&lt;</span><span class="nt">p</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: #666; font-size: 0.9em;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>                By {{ post.author }} on {{ post.created_at }}
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>            <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin: 15px 0; white-space: pre-wrap;&quot;</span><span class="p">&gt;</span>{{ post.content }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>            {% if session.username == post.author %}
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>            <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/posts/delete/{{ post.id }}&quot;</span> 
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>                <span class="na">onsubmit</span><span class="o">=</span><span class="s">&quot;return confirm(&#39;Are you sure you want to delete this post?&#39;);&quot;</span>
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>                <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-top: 10px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a>                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;background: #dc3545; color: white; </span>
<a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="s">                                            border: none; padding: 8px 12px; </span>
<a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="s">                                            border-radius: 4px; cursor: pointer;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>                    Delete Post
<a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a>                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a>            <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>            {% endif %}
<a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a>        <span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
<a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a>        {% endfor %}
<a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a>    {% else %}
<a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a>        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>No posts yet. Be the first to create one!<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a>    {% endif %}
<a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a>{% endblock %}
</code></pre></div>
<p><strong>templates/create_post.html:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>{% block title %}Create Post{% endblock %}
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>{% block content %}
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Create New Blog Post<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    {% if error %}
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color: red; padding: 10px; background: #ffebee; margin-bottom: 10px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>            {{ error }}
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>    {% endif %}
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;title&quot;</span><span class="p">&gt;</span>Title:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">required</span> 
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>                <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;100&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 100%; padding: 8px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-bottom: 15px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;content&quot;</span><span class="p">&gt;</span>Content:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>            <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;content&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;content&quot;</span> <span class="na">required</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;10&quot;</span> 
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>                    <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;5000&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 100%; padding: 8px;&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding: 10px 20px; background: #28a745; </span>
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a><span class="s">                                    color: white; border: none; border-radius: 4px; </span>
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="s">                                    cursor: pointer;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a>            Publish Post
<a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a>        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a>        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/posts&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin-left: 10px;&quot;</span><span class="p">&gt;</span>Cancel<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a>{% endblock %}
</code></pre></div>
</details>
<hr />
<h2 id="assessment-next-steps">Assessment &amp; Next Steps</h2>
<h3 id="self-assessment-checklist">Self-Assessment Checklist</h3>
<p>Rate your confidence (1-5) on each outcome:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I understand how web servers process HTTP requests</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can create routes and handle GET/POST requests</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can use template engines to render dynamic HTML</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I understand why password hashing is critical</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can implement secure authentication with bcrypt</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can validate and sanitise user inputs</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can identify common security vulnerabilities</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> I can build a complete authenticated web application</li>
</ul>
<h3 id="quiz">Quiz</h3>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-0">
                <a href="#quiz-0" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>"Question 1: What is the primary purpose of password hashing in web applications?"</strong></p>
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-0-0" ><label for="quiz-0-0">To encrypt passwords so they can be decrypted later when needed</label></div><div><input type="radio" name="answer" value="1" id="quiz-0-1" ><label for="quiz-0-1">To compress passwords to save database storage space</label></div><div><input type="radio" name="answer" value="2" id="quiz-0-2" correct><label for="quiz-0-2">To create a one-way transformation that cannot be reversed to obtain the original password</label></div><div><input type="radio" name="answer" value="3" id="quiz-0-3" ><label for="quiz-0-3">To make passwords longer and more complex for users</label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><hr />
<p><strong>Explanation</strong></p>
<p>Password hashing creates a one-way cryptographic transformation. Unlike encryption (which is reversible), hashing cannot be reversed to obtain the original password. This protects user passwords even if the database is compromised. </p>
<ul>
<li>Option A is incorrect because hashing is one-way (not encryption)</li>
<li>Option B is incorrect as compression is not the purpose</li>
<li>Option D is incorrect as hashing doesn't change the user's password itself</li>
</ul></section>
            </div>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-1">
                <a href="#quiz-1" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>Question 2: A student creates a Flask route - which statement best describes a security issue?</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">profile</span><span class="p">():</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;h1&gt;Welcome </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&lt;/h1&gt;&quot;</span>
</code></pre></div></p>
<hr />
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-1-0" ><label for="quiz-1-0">The route should use POST instead of GET for better security</label></div><div><input type="radio" name="answer" value="1" id="quiz-1-1" correct><label for="quiz-1-1">The username parameter is not validated or sanitised, allowing potential XSS attacks</label></div><div><input type="radio" name="answer" value="2" id="quiz-1-2" ><label for="quiz-1-2">Flask automatically sanitises all input, so this code is secure</label></div><div><input type="radio" name="answer" value="3" id="quiz-1-3" ><label for="quiz-1-3">The route should check if the user is logged in before displaying the profile</label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><p><strong>Explanation</strong>
The code directly inserts user input (<code>username</code>) into HTML without any validation or sanitisation. An attacker could pass <code>username=&lt;script&gt;alert('XSS')&lt;/script&gt;</code> to execute malicious JavaScript.</p>
<ul>
<li>Option A is incorrect because GET is acceptable for retrieving data (though authentication should be checked)</li>
<li>Option C is completely falseFlask does not automatically sanitise input in f-strings</li>
<li>Option D identifies another issue but is not the primary security vulnerability shown in this code pattern</li>
</ul></section>
            </div>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-2">
                <a href="#quiz-2" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>Question 3: Which code snippet correctly verifies the password 'MyPassword123'?</strong></p>
<div class="highlight"><pre><span></span><code>The stored password hash in the database is:
</code></pre></div>
<p><code>$2b$12$KIXr7QFWGhEwqYLx8E5.3.zX8kP6vY9fJ2rN4sT1uV3wX5yZ7aB2C</code></p>
<hr />
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-2-0" ><label for="quiz-2-0"><code>if hash_password("MyPassword123") == stored_hash: login_success()</code></label></div><div><input type="radio" name="answer" value="1" id="quiz-2-1" ><label for="quiz-2-1"><code>if "MyPassword123" == decrypt_password(stored_hash): login_success()</code></label></div><div><input type="radio" name="answer" value="2" id="quiz-2-2" correct><label for="quiz-2-2"><code>if bcrypt.checkpw("MyPassword123".encode('utf-8'), stored_hash.encode('utf-8')): login_success()</code></label></div><div><input type="radio" name="answer" value="3" id="quiz-2-3" ><label for="quiz-2-3"><code>if stored_hash.verify("MyPassword123"): login_success()</code></label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><p><strong>Explanation</strong>
Option C correctly uses <code>bcrypt.checkpw()</code> to verify the password against the stored hash. It properly encodes the password to bytes and compares it with the hash. The bcrypt algorithm handles the salt extraction and comparison internally.</p>
<ul>
<li>Option A is incorrect because hashing the input password again will produce a different hash due to a new random saltyou cannot compare hashes directly</li>
<li>Option B is incorrect because hashing is one-way and cannot be decrypted</li>
<li>Option D is incorrect because bcrypt hashes are byte strings, not objects with methods</li>
</ul></section>
            </div>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-3">
                <a href="#quiz-3" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>Question 4: Compare these two session management approaches - which analysis is correct?</strong></p>
<p><strong>Developer A's approach:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dashboard</span><span class="p">():</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">user_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="k">if</span> <span class="n">user_id</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>            <span class="n">user</span> <span class="o">=</span> <span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;dashboard.html&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Developer B's approach:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>    <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dashboard</span><span class="p">():</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logged_in&#39;</span><span class="p">):</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="n">user_id</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        <span class="n">user</span> <span class="o">=</span> <span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;dashboard.html&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</code></pre></div></p>
<hr />
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-3-0" ><label for="quiz-3-0">Developer A's approach is more secure because cookies are encrypted by the browser</label></div><div><input type="radio" name="answer" value="1" id="quiz-3-1" correct><label for="quiz-3-1">Developer B's approach is more secure because server-side sessions are harder to manipulate than client-side cookies</label></div><div><input type="radio" name="answer" value="2" id="quiz-3-2" ><label for="quiz-3-2">Both approaches are equally secure as long as HTTPS is used</label></div><div><input type="radio" name="answer" value="3" id="quiz-3-3" ><label for="quiz-3-3">Developer A's approach is better because it reduces server load by not storing session data</label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><p><strong>Explanation</strong>
Developer B uses Flask's server-side session system (which stores session data on the server and only sends a session ID to the client). This is more secure because:</p>
<ul>
<li>Session data cannot be modified by the client</li>
<li>The session is cryptographically signed</li>
<li>Additional checks like <code>logged_in</code> status are stored server-side</li>
</ul>
<p>Developer A's approach is vulnerable because:</p>
<ul>
<li>Cookies can be easily modified by users using browser dev tools</li>
<li>A user could change <code>user_id=123</code> to <code>user_id=456</code> to access another user's dashboard</li>
<li>There's no verification that the user actually logged in</li>
</ul>
<p>Other options are incorrect:</p>
<ul>
<li>Option A: cookies are not encrypted by default</li>
<li>Option C: HTTPS encrypts transmission but doesn't prevent client-side cookie manipulation</li>
<li>Option D: identifies a performance consideration but ignores the critical security flaw</li>
</ul></section>
            </div>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-4">
                <a href="#quiz-4" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>Question 5: Evaluate these security measures for a student portal - which evaluation is most accurate?</strong></p>
<p><strong>Proposed security measures:</strong></p>
<ol>
<li>Password Policy: Minimum 8 characters, no complexity requirements</li>
<li>Hashing Algorithm: SHA-256 without salting</li>
<li>Session Timeout: 24 hours of inactivity</li>
<li>Input Validation: Client-side JavaScript validation only</li>
<li>HTTPS: Only on the login page, HTTP for other pages</li>
</ol>
<hr />
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-4-0" ><label for="quiz-4-0">The security measures are adequate for a school environment since students aren't high-value targets</label></div><div><input type="radio" name="answer" value="1" id="quiz-4-1" correct><label for="quiz-4-1">Measures 1 and 3 are acceptable, but measures 2, 4, and 5 have critical security flaws that must be addressed</label></div><div><input type="radio" name="answer" value="2" id="quiz-4-2" ><label for="quiz-4-2">All measures except 3 are secure; the session timeout should be reduced to 1 hour</label></div><div><input type="radio" name="answer" value="3" id="quiz-4-3" ><label for="quiz-4-3">The measures are acceptable if the school also implements two-factor authentication</label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><p><strong>Explanation</strong>
Let's evaluate each measure:</p>
<p><strong>Measure 1 (Acceptable):</strong> 8 characters minimum is the bare minimum acceptable. While complexity requirements are debated, length is most important.</p>
<p><strong>Measure 2 (CRITICAL FLAW):</strong> SHA-256 without salting is vulnerable to rainbow table attacks. Even with salting, SHA-256 is too fast for password hashing. Should use bcrypt, scrypt, or Argon2 with proper salting.</p>
<p><strong>Measure 3 (Acceptable):</strong> 24-hour timeout is reasonable for a student portal.</p>
<p><strong>Measure 4 (CRITICAL FLAW):</strong> Client-side validation can be completely bypassed using browser dev tools or direct HTTP requests. Server-side validation is mandatory for security.</p>
<p><strong>Measure 5 (CRITICAL FLAW):</strong> Using HTTP for authenticated sessions means session cookies and all data are sent in plain text. An attacker on school WiFi could steal session cookies. HTTPS must be used site-wide.</p>
<p>Why other options are incorrect:</p>
<ul>
<li>Option A: security shouldn't be compromised based on perceived threat level; student data is protected by privacy laws</li>
<li>Option C: incorrectly identifies only one issue</li>
<li>Option D: 2FA doesn't fix the fundamental flaws in measures 2, 4, and 5</li>
</ul></section>
            </div>
<div class="quiz" data-show-correct="true" data-auto-submit="true" data-disable-after-submit="true" id="quiz-5">
                <a href="#quiz-5" class="quiz-header-link">#</a>

                <div class="quiz-question">
                    <p><strong>Question 6: Design a secure authentication system for a medical records application</strong></p>
<p><strong>Scenario:</strong> You are building a web application for a medical clinic that stores patient records. The system needs:</p>
<ul>
<li>Different user types: patients can view their own records, doctors can view/edit patient records, admins can manage all users</li>
<li>Protection against unauthorised access to sensitive medical data</li>
<li>A record of who accessed which patient files and when (for legal compliance)</li>
<li>Protection from common attacks (XSS, SQL injection, session hijacking, etc.)</li>
</ul>
<hr />
<p><strong>Question:</strong> Which security implementation provides the MOST complete protection for this medical application?</p>
                </div>
                <form action="javascript:void(0);" onsubmit="return false;">
                    <fieldset><div><input type="radio" name="answer" value="0" id="quiz-5-0" ><label for="quiz-5-0"><strong>Option A:</strong> bcrypt password hashing <em><br> Users' access levels checked using JavaScript in the browser<br> Sessions expire after 15 minutes<br> HTTPS on all pages<br> Form validation</em></label></div><div><input type="radio" name="answer" value="1" id="quiz-5-1" correct><label for="quiz-5-1"><strong>Option B:</strong> Argon2 password hashing <em><br> Access permissions checked on the server against a database of user roles<br> Sessions expire after 15 minutes AND session IDs change after login<br> HTTPS on all pages with forced HTTPS redirect<br> All inputs validated on server with SQL injection protection<br> Every file access is logged with username, timestamp, and which record was accessed</em></label></div><div><input type="radio" name="answer" value="2" id="quiz-5-2" ><label for="quiz-5-2"><strong>Option C:</strong> Passwords stored without hashing (the database file itself is encrypted)<em><br> Access control on server<br> Sessions never expire for doctor convenience<br> HTTPS only on login page<br> Validation on both client and server</em></label></div><div><input type="radio" name="answer" value="3" id="quiz-5-3" ><label for="quiz-5-3"><strong>Option D:</strong> bcrypt password hashing<em><br> Access permissions managed by JavaScript code<br> Sessions last 24 hours<br> HTTPS on all pages<br> User inputs are cleaned before use</em></label></div></fieldset>
                    <div class="quiz-feedback hidden"></div>

                </form>
                <section class="content hidden"><p><strong>Explanation</strong></p>
<p><strong>Correct Answer: Option B</strong></p>
<p>Medical applications require the highest security standards due to privacy laws (like HIPAA in the US or similar regulations). Option B is the only one that addresses ALL critical requirements:</p>
<hr />
<p><strong>Why Option B is the BEST choice:</strong></p>
<p> <strong>Argon2 password hashing</strong></p>
<ul>
<li>Most secure modern algorithm, specifically designed to resist specialised hardware attacks</li>
<li>Better than bcrypt for high-security applications</li>
</ul>
<p> <strong>Server-side role checking against database</strong></p>
<ul>
<li>Users cannot modify their own permissions</li>
<li>Every page load verifies: "Does this user REALLY have permission to see this data?"</li>
</ul>
<p> <strong>Session timeout + ID regeneration</strong></p>
<ul>
<li>15-minute timeout prevents abandoned computers from being used</li>
<li>Changing session ID after login prevents "session fixation" attacks</li>
</ul>
<p> <strong>HTTPS everywhere with forced redirect</strong></p>
<ul>
<li>All data encrypted in transit</li>
<li>Automatic redirect prevents accidentally using HTTP</li>
</ul>
<p> <strong>Server validation + SQL injection protection</strong></p>
<ul>
<li>Using prepared statements makes SQL injection impossible</li>
<li>Server validation cannot be bypassed by users</li>
</ul>
<p> <strong>Audit logging</strong></p>
<ul>
<li><strong>CRITICAL for medical applications</strong> - required by law</li>
<li>If there's a privacy breach, you can trace who accessed what and when</li>
</ul>
<hr />
<p><strong>Why the other options FAIL:</strong></p>
<p> <strong>Option A has a CRITICAL flaw:</strong></p>
<ul>
<li>"Access levels checked using JavaScript in the browser" means any user can open browser dev tools (F12) and change their role from "patient" to "doctor" or "admin"</li>
<li>They could then access ANY patient's records</li>
<li><strong>This is completely unacceptable for medical data</strong></li>
<li>Also missing: audit logging (legally required)</li>
</ul>
<p> <strong>Option C has MULTIPLE critical flaws:</strong></p>
<ul>
<li><strong>Plain text passwords:</strong> If someone steals the database file, they have everyone's passwords immediately (even if the file is encrypted, once they decrypt it, passwords are exposed)</li>
<li><strong>No session timeout:</strong> A doctor could log in, walk away from their computer, and anyone could access patient records</li>
<li><strong>HTTPS only on login:</strong> After login, all data (including patient records) is sent unencrypted over the network where it can be intercepted</li>
<li><strong>Missing:</strong> Audit logging</li>
</ul>
<p> <strong>Option D has critical flaws:</strong></p>
<ul>
<li><strong>JavaScript access control:</strong> Same problem as Option A - users can bypass it entirely</li>
<li><strong>24-hour sessions:</strong> Far too long for medical data - an unlocked computer could be used all day</li>
<li><strong>No SQL injection protection mentioned</strong></li>
<li><strong>Missing:</strong> Audit logging</li>
</ul>
<hr />
<p><strong>Real-World Context:</strong></p>
<p>Medical applications face legal requirements like:</p>
<ul>
<li><strong>HIPAA (USA):</strong> Requires audit trails, encryption, access controls</li>
<li><strong>GDPR (Europe):</strong> Requires data protection by design</li>
<li><strong>Australian Privacy Principles:</strong> Require reasonable security measures</li>
</ul>
<p>A security breach in medical software can result in:</p>
<ul>
<li>Massive fines (up to millions of dollars)</li>
<li>Legal liability</li>
<li>Loss of patient trust</li>
<li>Harm to patients if records are altered</li>
</ul>
<p>This is why medical systems need <strong>defence in depth</strong> - multiple layers of security so that if one fails, others still protect the data.</p></section>
            </div>

<h3 id="extension-activities">Extension Activities</h3>
<p>If you completed everything and want to go further:</p>
<ol>
<li><strong>Add Password Reset:</strong> Email-based password recovery</li>
<li><strong>Implement Rate Limiting:</strong> Prevent brute force login attempts</li>
<li><strong>Add Profile Pictures:</strong> File upload with validation</li>
<li><strong>Email Verification:</strong> Require users to verify email before login</li>
<li><strong>Two-Factor Authentication:</strong> Add TOTP-based 2FA</li>
<li><strong>Database Integration:</strong> Replace simulated database with SQLite/PostgreSQL</li>
<li><strong>API Development:</strong> Create RESTful API endpoints</li>
<li><strong>OAuth Integration:</strong> Add "Login with Google" functionality</li>
</ol>
<h3 id="additional-resources">Additional Resources</h3>
<ul>
<li><strong>Flask Documentation:</strong> https://flask.palletsprojects.com/</li>
<li><strong>OWASP Top 10:</strong> https://owasp.org/www-project-top-ten/</li>
<li><strong>Web Security Academy:</strong> https://portswigger.net/web-security</li>
<li><strong>Real Python Flask Tutorial:</strong> https://realpython.com/tutorials/flask/</li>
<li><strong>MDN Web Security:</strong> https://developer.mozilla.org/en-US/docs/Web/Security</li>
</ul>
<hr />
<h3 id="syllabus-alignment">Syllabus Alignment</h3>
<p><strong>Programming for the Web:</strong></p>
<p> Model elements of web development system</p>
<ul>
<li>client-side (front-end) web programming</li>
<li>server-side (back-end) web programming</li>
</ul>
<p> Observe and describe the back-end process used to manage a web request</p>
<ul>
<li>role of webserver software</li>
<li>web framework</li>
<li>libraries</li>
</ul>
<p> Develop a web application using an appropriate scripting language with shell scripts to make files and directories, and searching for text in a text file</p>
<p> Explore the types and significance of code libraries for front-end web development</p>
<ul>
<li>frameworks that control complex web applications</li>
<li>template engines</li>
</ul>
<p><strong>Secure Software Architecture:</strong></p>
<p> Explore fundamental software design security concepts when developing programming code</p>
<ul>
<li>Authentication</li>
<li>authorisation</li>
<li>accountability</li>
</ul>
<p> Use and explain the contribution of cryptography and sandboxing to the security by design approach in the development of software solutions</p>
<p> Design, develop and implement code using defensive data input handling practices, including input validation, sanitisation and error handling</p>
<p> Design, develop and implement secure code to minimise vulnerabilities in user action controls</p>
<ul>
<li>broken authentication and session management</li>
<li>cross-site scripting (XSS) and cross-site request forgery (CSRF)</li>
</ul>
<p>  Design, develop and implement code considering efficient execution for the user</p>
<ul>
<li>memory management</li>
<li>session management</li>
<li>exception management</li>
</ul>
<p> Test and evaluate the security and resilience of software by determining vulnerabilities, hardening systems, handling breaches, maintaining business continuity and conducting disaster recovery</p>
<h2 id="teacher-notes">Teacher Notes</h2>
<details>
<summary>Differentiation Strategies</summary>
<p><strong>For Students Who Need Support:</strong></p>
<ul>
<li>Provide the complete code files and have them modify specific functions</li>
<li>Use pair programming approach (even self-paced, students can review together)</li>
<li>Create a checklist version of each section to track progress</li>
<li>Offer simplified challenges (e.g., "add one more route" instead of "build blog system")</li>
<li>Provide video walkthrough of key concepts (you can record yourself)</li>
<li>Use visual debugging: print statements to trace code execution</li>
</ul>
<p><strong>For Advanced Students:</strong></p>
<ul>
<li>Challenge them to implement the extension activities</li>
<li>Ask them to refactor code using decorators for authentication checks</li>
<li>Have them research and implement Argon2 instead of bcrypt</li>
<li>Request they create a comprehensive security testing suite</li>
<li>Encourage exploration of async frameworks (FastAPI, Quart)</li>
<li>Ask them to implement a JSON API alongside the HTML interface</li>
</ul>
<p><strong>Accessibility Considerations:</strong></p>
<ul>
<li>Ensure all code examples have clear comments</li>
<li>Provide text descriptions of diagrams</li>
<li>Use high-contrast code highlighting</li>
<li>Offer transcripts if creating video content</li>
<li>Allow extra time for hands-on activities</li>
</ul>
</details>
<details>
<summary>Common Misconceptions</summary>
<ol>
<li>
<p><strong>"Client-side validation is enough for security"</strong></p>
<ul>
<li>Reality: Client-side can be bypassed; always validate server-side</li>
<li>Address: Show how to bypass HTML5 validation using dev tools</li>
</ul>
</li>
<li>
<p><strong>"Hashing and encryption are the same thing"</strong></p>
<ul>
<li>Reality: Hashing is one-way; encryption is reversible</li>
<li>Address: Use analogies (hashing = shredding paper, encryption = locked box)</li>
</ul>
</li>
<li>
<p><strong>"Sessions and cookies are the same thing"</strong></p>
<ul>
<li>Reality: Session is server-side data; cookie is client-side storage</li>
<li>Address: Draw diagram showing client-server interaction</li>
</ul>
</li>
<li>
<p><strong>"More complex passwords = more secure storage"</strong></p>
<ul>
<li>Reality: Password complexity helps against guessing, but hashing protects storage</li>
<li>Address: Explain different attack vectors (brute force vs database breach)</li>
</ul>
</li>
<li>
<p><strong>"If it works, it's secure"</strong></p>
<ul>
<li>Reality: Functionality  security</li>
<li>Address: Show working but vulnerable code, then exploit it</li>
</ul>
</li>
<li>
<p><strong>"Template engines are just for convenience"</strong></p>
<ul>
<li>Reality: They also provide automatic XSS protection</li>
<li>Address: Demonstrate XSS vulnerability with manual HTML concatenation</li>
</ul>
</li>
</ol>
</details>
<details>
<summary>Formative Assessment Opportunities</summary>
<p><strong>Throughout the Lesson:</strong></p>
<ul>
<li><strong>Check Your Understanding questions</strong> - Monitor conceptual grasp</li>
<li><strong>Practice Activities</strong> - Assess ability to apply concepts</li>
<li><strong>Code Review exercises</strong> - Evaluate analytical skills</li>
<li><strong>Security Testing tasks</strong> - Check security awareness</li>
</ul>
<p><strong>Observable Indicators of Understanding:</strong></p>
<p> <strong>Student is on track if they:</strong></p>
<ul>
<li>Complete routes work and return expected responses</li>
<li>Templates render correctly with dynamic data</li>
<li>Authentication system successfully registers and logs in users</li>
<li>Can explain why password hashing is necessary</li>
<li>Identify at least 3 vulnerabilities in the code review</li>
</ul>
<p> <strong>Student may need support if they:</strong></p>
<ul>
<li>Routes return 404 or 500 errors consistently</li>
<li>Templates show variable names instead of values (e.g., <code>{{ username }}</code> appears literally)</li>
<li>Cannot explain the difference between GET and POST</li>
<li>Skip server-side validation</li>
<li>Confused about where code executes (client vs server)</li>
</ul>
<p><strong>Intervention Strategies:</strong></p>
<ul>
<li>Debugging checklist: Is server running? Correct route? Template in templates folder?</li>
<li>Pair them with a peer who's progressing well</li>
<li>Provide partially completed code with TODO comments</li>
<li>Schedule brief check-in to review their approach</li>
<li>Offer alternative examples in different context (e.g., e-commerce instead of blog)</li>
</ul>
</details>
<h3 id="technical-troubleshooting">Technical Troubleshooting</h3>
<p><strong>Common Technical Issues:</strong></p>
<table>
<thead>
<tr>
<th>Problem</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>"Module not found"</td>
<td>Package not installed</td>
<td><code>pip install flask bcrypt</code></td>
</tr>
<tr>
<td>"Port already in use"</td>
<td>Server still running</td>
<td>Kill process or use different port</td>
</tr>
<tr>
<td>"Template not found"</td>
<td>Wrong folder structure</td>
<td>Ensure <code>templates/</code> folder exists</td>
</tr>
<tr>
<td>404 errors</td>
<td>Typo in route</td>
<td>Check URL matches <code>@app.route()</code> exactly</td>
</tr>
<tr>
<td>Form submission fails</td>
<td>Method mismatch</td>
<td>Ensure route accepts POST: <code>methods=['POST']</code></td>
</tr>
<tr>
<td>Session not persisting</td>
<td>No secret key</td>
<td>Add <code>app.secret_key</code></td>
</tr>
<tr>
<td>Password verification fails</td>
<td>Encoding issue</td>
<td>Ensure <code>.encode('utf-8')</code> is used</td>
</tr>
</tbody>
</table>
<p><strong>Setup Verification Script:</strong></p>
<p>Provide this to students to check their environment:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># setup_check.py</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Python version:&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">flask</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Flask installed:&quot;</span><span class="p">,</span> <span class="n">flask</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Flask NOT installed - run: pip install flask&quot;</span><span class="p">)</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; bcrypt installed&quot;</span><span class="p">)</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; bcrypt NOT installed - run: pip install bcrypt&quot;</span><span class="p">)</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">If all items show , you&#39;re ready to start!&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Blooms Taxonomy:</strong></p>
<ul>
<li><strong>Remember:</strong> Security concepts, HTTP methods, hashing vs encryption</li>
<li><strong>Understand:</strong> Request-response cycle, client-server architecture</li>
<li><strong>Apply:</strong> Create routes, implement authentication, use templates</li>
<li><strong>Analyse:</strong> Identify vulnerabilities in code, compare secure vs insecure practices</li>
<li><strong>Evaluate:</strong> Assess code security, test authentication system</li>
<li><strong>Create:</strong> Build complete authenticated web application</li>
</ul><style type="text/css">.quiz {
  border: 1px solid black;
  padding: 1rem;
  margin: 1rem 0;
  position: relative;
}
/* Set margin-top of first quiz child (skip the header link) */
.quiz > .quiz-question:first-of-type {
  margin-top: 0;
}
/* Remove top margin from first element inside quiz-question */
.quiz-question > *:first-child {
  margin-top: 0;
}
.hidden {
  display: none;
}

form button {
  background-color: var(--md-primary-fg-color);
  border: none;
  color: var(--md-primary-bg-color);
  padding: 0.5rem 1rem;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 0.8rem;
  cursor: pointer;
  transition:
    opacity 0.2s,
    background-color 0.2s;
}

form button:hover:not(:disabled) {
  opacity: 0.9;
}

form button:disabled {
  background-color: var(--md-default-fg-color--lighter, #ccc);
  color: var(--md-default-fg-color--light, #666);
  cursor: not-allowed;
  opacity: 0.6;
}

.wrong label,
.wrong label * {
  color: #dc3545;
}
.correct label,
.correct label * {
  color: #198754;
}

fieldset {
  border: none;
  display: flex;
  flex-direction: column;
}
fieldset input {
  margin: 0 10px;
}
fieldset label {
  margin: 0 10px;
}

input[type="radio"].correct {
  accent-color: #198754;
}
input[type="radio"].wrong {
  accent-color: #dc3545;
}
.content {
  margin: 10px;
}

/* Quiz feedback message */
.quiz-feedback {
  padding: 0.75rem;
  margin: 0.5rem 0;
  border-radius: 4px;
  font-weight: 500;
}

.quiz-feedback.correct {
  background-color: #d1e7dd;
  border: 1px solid #a3cfbb;
  color: #198754;
}

.quiz-feedback.incorrect {
  background-color: #f8d7da;
  border: 1px solid #f1aeb5;
  color: #dc3545;
}

[data-md-color-scheme="slate"] .quiz-feedback.correct {
  background-color: #051b11;
  border: 1px solid #0f5132;
}

[data-md-color-scheme="slate"] .quiz-feedback.incorrect {
  background-color: #2c0b0e;
  border: 1px solid #842029;
}

/* Quiz header link styling - positioned in top right corner */
.quiz-header-link {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  opacity: 0;
  font-size: 1rem;
  text-decoration: none;
  color: var(--md-default-fg-color--light, #888);
  transition: opacity 0.2s;
  padding: 0.25rem 0.5rem;
}
.quiz:hover .quiz-header-link {
  opacity: 1;
}

/* Quiz number header styling */
.quiz-number {
  margin-top: 0 !important;
  margin-bottom: 0.5rem;
  font-weight: bold;
}

/* Quiz Progress Sidebar - Progress bar styling */
/* Most styling comes from Material's .md-nav classes */
#quiz-progress-sidebar {
  margin-top: 1.5rem;
}
/* if config progress_sidebar_position is top, need top padding instead of bottom */
.md-nav--secondary > #quiz-progress-sidebar:first-child {
  margin-top: 0;
  margin-bottom: 1.5rem;
}
@media screen and (min-width: 59.9375em) {
  #quiz-progress-sidebar .md-nav__list {
    border-left: 3px solid var(--md-default-fg-color--lightest);
  }
}

.quiz-progress-bar {
  width: 100%;
  height: 6px;
  background: var(--md-default-fg-color--lightest, rgba(0, 0, 0, 0.07));
  border-radius: 3px;
  overflow: hidden;
  margin: 0.2rem 0;
  display: flex;
}

.quiz-progress-bar-incorrect {
  height: 100%;
  background: rgba(244, 67, 54, 0.8);
  transition: width 0.3s ease;
}

.quiz-progress-bar-correct {
  height: 100%;
  background: #4caf50;
  transition: width 0.3s ease;
}

.quiz-correct-reset {
  display: flex;
  justify-content: space-between;
}

/* Mobile Quiz Progress Tracker */
/* Shows under navbar on mobile, hidden on desktop */
.quiz-progress-mobile {
  display: none; /* Hidden by default on desktop */
  background-color: var(--md-default-bg-color);
  border-bottom: 1px solid var(--md-default-fg-color--lightest, rgba(0, 0, 0, 0.07));
  padding: 0.8rem;
  margin: 0;
  width: 100%;
  box-sizing: border-box;
  position: sticky;
  top: 48px;
  z-index: 3; /* Below Material header (z-index: 4) but above page content */
}

/* Show mobile tracker only on small screens (mobile/tablet) */
/* Material breakpoint: up to 76.1875em (1219px) */
@media screen and (max-width: 76.1875em) {
  .quiz-progress-mobile {
    display: block;
  }
}

/* Mobile tracker styling adjustments */
.quiz-progress-mobile .md-nav__list {
  padding: 0;
  margin: 0;
  max-width: 61rem;
  margin-left: auto;
  margin-right: auto;
  padding-left: 0.8rem;
  padding-right: 0.8rem;
}

.quiz-progress-mobile .md-nav__item {
  margin: 0.3rem 0;
}

.quiz-progress-mobile .md-nav__link {
  padding: 0.2rem 0;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.quiz-progress-mobile .quiz-progress-bar {
  margin: 0.3rem 0;
}

.quiz-progress-mobile .md-ellipsis {
  flex: 1;
}

/* Quiz Intro */
.quiz-intro {
  margin: 1rem 0;
}

.quiz-intro p {
  margin: 0 0 0.5rem 0;
}

/* Quiz Results End Screen */
.quiz-results {
  border: 1px solid black;
  padding: 1.5rem;
  margin: 2rem 0;
  background-color: var(--md-default-bg-color);
  transition: all 0.3s ease;
}

/* Progress state - subtle styling */
.quiz-results-progress {
  text-align: center;
  color: var(--md-default-fg-color--light);
}

.quiz-results-progress h3 {
  margin-top: 0;
  font-size: 1.2rem;
  font-weight: 500;
  color: var(--md-default-fg-color);
}

.quiz-results-stats,
.quiz-results-correct-stats {
  font-size: 0.95rem;
  margin: 0.5rem 0;
}

.quiz-results-answered,
.quiz-results-correct,
.quiz-results-total,
.quiz-results-percentage {
  font-weight: 600;
  color: var(--md-default-fg-color);
}

/* Complete state - bold and prominent styling */
.quiz-results-complete {
  text-align: center;
  padding: 2rem 0;
}

.quiz-results-complete.hidden {
  display: none;
}

.quiz-results-title {
  font-size: 2rem;
  font-weight: 700;
  margin: 0 0 1.5rem 0;
  color: var(--md-default-fg-color);
}

.quiz-results-score-display {
  margin: 1.5rem 0;
}

.quiz-results-score-value {
  font-size: 4rem;
  font-weight: 800;
  line-height: 1;
  display: inline-block;
  padding: 0.5rem 1rem;
  border-radius: 12px;
  transition: all 0.3s ease;
}

/* Score color coding */
.quiz-results-score-excellent {
  color: #198754;
  background-color: rgba(25, 135, 84, 0.1);
}

.quiz-results-score-good {
  color: #28a745;
  background-color: rgba(40, 167, 69, 0.1);
}

.quiz-results-score-average {
  color: #ffc107;
  background-color: rgba(255, 193, 7, 0.1);
}

.quiz-results-score-poor {
  color: #fd7e14;
  background-color: rgba(253, 126, 20, 0.1);
}

.quiz-results-score-fail {
  color: #dc3545;
  background-color: rgba(220, 53, 69, 0.1);
}

.quiz-results-message {
  font-size: 1.3rem;
  font-weight: 500;
  margin: 1rem 0 2rem 0;
  color: var(--md-default-fg-color);
}

/* Dark mode adjustments */
[data-md-color-scheme="slate"] .quiz-results-score-excellent {
  color: #4caf50;
  background-color: rgba(76, 175, 80, 0.15);
}

[data-md-color-scheme="slate"] .quiz-results-score-good {
  color: #66bb6a;
  background-color: rgba(102, 187, 106, 0.15);
}

[data-md-color-scheme="slate"] .quiz-results-score-average {
  color: #ffeb3b;
  background-color: rgba(255, 235, 59, 0.15);
}

[data-md-color-scheme="slate"] .quiz-results-score-poor {
  color: #ff9800;
  background-color: rgba(255, 152, 0, 0.15);
}

[data-md-color-scheme="slate"] .quiz-results-score-fail {
  color: #f44336;
  background-color: rgba(244, 67, 54, 0.15);
}
</style><script type="text/javascript">var JSConfetti=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function n(t){return+t.replace(/px/,"")}function s(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.random()*(e-t)+t;return Math.floor(n*Math.pow(10,i))/Math.pow(10,i)}function o(t){return t[s(0,t.length)]}var a=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function r(t){return Math.log(t)/Math.log(1920)}var h=function(){function e(i){t(this,e);var n=i.initialPosition,a=i.direction,h=i.confettiRadius,c=i.confettiColors,u=i.emojis,l=i.emojiSize,d=i.canvasWidth,f=s(.9,1.7,3)*r(d);this.confettiSpeed={x:f,y:f},this.finalConfettiSpeedX=s(.2,.6,3),this.rotationSpeed=u.length?.01:s(.03,.07,3)*r(d),this.dragForceCoefficient=s(5e-4,9e-4,6),this.radius={x:h,y:h},this.initialRadius=h,this.rotationAngle="left"===a?s(0,.2,3):s(-.2,0,3),this.emojiSize=l,this.emojiRotationAngle=s(0,2*Math.PI),this.radiusYUpdateDirection="down";var m="left"===a?s(82,15)*Math.PI/180:s(-15,-82)*Math.PI/180;this.absCos=Math.abs(Math.cos(m)),this.absSin=Math.abs(Math.sin(m));var v=s(-150,0),p={x:n.x+("left"===a?-v:v)*this.absCos,y:n.y-v*this.absSin};this.currentPosition=Object.assign({},p),this.initialPosition=Object.assign({},p),this.color=u.length?null:o(c),this.emoji=u.length?o(u):null,this.createdAt=(new Date).getTime(),this.direction=a}return i(e,[{key:"draw",value:function(t){var e=this.currentPosition,i=this.radius,n=this.color,s=this.emoji,o=this.rotationAngle,a=this.emojiRotationAngle,r=this.emojiSize,h=window.devicePixelRatio;n?(t.fillStyle=n,t.beginPath(),t.ellipse(e.x*h,e.y*h,i.x*h,i.y*h,o,0,2*Math.PI),t.fill()):s&&(t.font="".concat(r,"px serif"),t.save(),t.translate(h*e.x,h*e.y),t.rotate(a),t.textAlign="center",t.fillText(s,0,0),t.restore())}},{key:"updatePosition",value:function(t,e){var i=this.confettiSpeed,n=this.dragForceCoefficient,s=this.finalConfettiSpeedX,o=this.radiusYUpdateDirection,a=this.rotationSpeed,r=this.createdAt,h=this.direction,c=e-r;i.x>s&&(this.confettiSpeed.x-=n*t),this.currentPosition.x+=i.x*("left"===h?-this.absCos:this.absCos)*t,this.currentPosition.y=this.initialPosition.y-i.y*this.absSin*c+.00125*Math.pow(c,2)/2,this.rotationSpeed-=this.emoji?1e-4:1e-5*t,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji?this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI):"down"===o?(this.radius.y-=t*a,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=t*a,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(t){return this.currentPosition.y<t+100}}]),e}();function c(){var t=document.createElement("canvas");return t.style.position="fixed",t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0",t.style.zIndex="1000",t.style.pointerEvents="none",document.body.appendChild(t),t}function u(t){var e=t.confettiRadius,i=void 0===e?6:e,n=t.confettiNumber,s=void 0===n?t.confettiesNumber||(t.emojis?40:250):n,o=t.confettiColors,r=void 0===o?a:o,h=t.emojis,c=void 0===h?t.emojies||[]:h,u=t.emojiSize,l=void 0===u?80:u;return t.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),t.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:i,confettiNumber:s,confettiColors:r,emojis:c,emojiSize:l}}var l=function(){function e(i){var n=this;t(this,e),this.canvasContext=i,this.shapes=[],this.promise=new Promise((function(t){return n.resolvePromise=t}))}return i(e,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var t;(t=this.shapes).push.apply(t,arguments)}},{key:"complete",value:function(){var t;return!this.shapes.length&&(null===(t=this.resolvePromise)||void 0===t||t.call(this),!0)}},{key:"processShapes",value:function(t,e,i){var n=this,s=t.timeDelta,o=t.currentTime;this.shapes=this.shapes.filter((function(t){return t.updatePosition(s,o),t.draw(n.canvasContext),!i||t.getIsVisibleOnCanvas(e)}))}}]),e}();return function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.activeConfettiBatches=[],this.canvas=i.canvas||c(),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=(new Date).getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return i(e,[{key:"loop",value:function(){var t,e,i,s,o;this.requestAnimationFrameRequested=!1,t=this.canvas,e=window.devicePixelRatio,i=getComputedStyle(t),s=n(i.getPropertyValue("width")),o=n(i.getPropertyValue("height")),t.setAttribute("width",(s*e).toString()),t.setAttribute("height",(o*e).toString());var a=(new Date).getTime(),r=a-this.lastUpdated,h=this.canvas.offsetHeight,c=this.iterationIndex%10==0;this.activeConfettiBatches=this.activeConfettiBatches.filter((function(t){return t.processShapes({timeDelta:r,currentTime:a},h,c),!c||!t.complete()})),this.iterationIndex++,this.queueAnimationFrameIfNeeded(a)}},{key:"queueAnimationFrameIfNeeded",value:function(t){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=t||(new Date).getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=u(t),i=e.confettiRadius,n=e.confettiNumber,s=e.confettiColors,o=e.emojis,a=e.emojiSize,r=this.canvas.getBoundingClientRect(),c=r.width,d=r.height,f=5*d/7,m={x:0,y:f},v={x:c,y:f},p=new l(this.canvasContext),y=0;y<n/2;y++){var g=new h({initialPosition:m,direction:"right",confettiRadius:i,confettiColors:s,confettiNumber:n,emojis:o,emojiSize:a,canvasWidth:c}),C=new h({initialPosition:v,direction:"left",confettiRadius:i,confettiColors:s,confettiNumber:n,emojis:o,emojiSize:a,canvasWidth:c});p.addShapes(g,C)}return this.activeConfettiBatches.push(p),this.queueAnimationFrameIfNeeded(),p.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}},{key:"destroyCanvas",value:function(){this.canvas.remove()}}]),e}()}();
</script><script type="text/javascript">
window.mkdocsQuizTranslations = {};
</script><script type="text/javascript">
window.mkdocsQuizConfig = {
  confetti: true,
  showProgress: true,
  progressSidebarPosition: "top"
};
</script><script type="text/javascript" defer>// Wrap everything in an IIFE to avoid variable redeclaration issues
// when Material for MkDocs instant navigation reloads the page
(function () {
  // Constants
  const STORAGE_KEY_PREFIX = "quiz_progress_";

  // Translation helper function
  function t(key, params = {}) {
    let text = window.mkdocsQuizTranslations?.[key] || key;
    // Simple template replacement for {n} and {key} style placeholders
    return text.replace(/{(\w+)}/g, (_, k) => (params[k] !== undefined ? params[k] : `{${k}}`));
  }

  // Confetti instance (will be initialized if enabled)
  let jsConfetti = null;

  // Store event listeners for cleanup
  let eventListeners = [];

  // Initialize confetti if enabled
  if (window.mkdocsQuizConfig && window.mkdocsQuizConfig.confetti) {
    if (typeof JSConfetti !== "undefined") {
      jsConfetti = new JSConfetti();
    }
  }

  // Function to move quiz progress sidebar into TOC sidebar
  // This needs to run on every page load for Material instant navigation
  function repositionSidebar() {
    // Use requestAnimationFrame to ensure DOM is ready
    requestAnimationFrame(() => {
      const sidebar = document.getElementById("quiz-progress-sidebar");
      const tocSidebar = document.querySelector(".md-sidebar--secondary .md-sidebar__inner .md-nav--secondary");

      if (sidebar && tocSidebar) {
        // Check if sidebar is already in the correct position
        // by seeing if it's already a child of tocSidebar
        if (!tocSidebar.contains(sidebar)) {
          // Get position from config (default: "top")
          const position =
            window.mkdocsQuizConfig && window.mkdocsQuizConfig.progressSidebarPosition
              ? window.mkdocsQuizConfig.progressSidebarPosition
              : "top";

          // Move sidebar based on configured position
          if (position === "bottom") {
            // Append to the end (below TOC)
            tocSidebar.appendChild(sidebar);
          } else {
            // Default: insert at the top (above TOC)
            if (tocSidebar.firstChild) {
              tocSidebar.insertBefore(sidebar, tocSidebar.firstChild);
            } else {
              tocSidebar.appendChild(sidebar);
            }
          }
        }
      }
    });
  }

  // Cleanup function to remove event listeners and prevent memory leaks
  function cleanup() {
    eventListeners.forEach(({ element, event, handler }) => {
      element.removeEventListener(event, handler);
    });
    eventListeners = [];
  }

  // Helper function to add tracked event listeners
  function addTrackedEventListener(element, event, handler) {
    element.addEventListener(event, handler);
    eventListeners.push({ element, event, handler });
  }

  // Global quiz tracker
  const quizTracker = {
    quizzes: {},
    totalQuizzes: 0,
    answeredQuizzes: 0,
    correctQuizzes: 0,

    init: function () {
      this.totalQuizzes = document.querySelectorAll(".quiz").length;
      this.loadFromStorage();
      // Initialize wasCompleted based on restored state to prevent confetti on page load
      // Only fire confetti when completing quizzes in the current session, not from localStorage
      const progress = this.getProgress();
      this.wasCompleted = progress.answered === progress.total && progress.total > 0;
      this.updateDisplay();
    },

    markQuiz: function (quizId, isCorrect, selectedValues = []) {
      const wasAnswered = !!this.quizzes[quizId];
      const wasCorrect = this.wasPreviouslyCorrect(quizId);

      if (!wasAnswered) {
        this.answeredQuizzes++;
      }

      this.quizzes[quizId] = {
        answered: true,
        correct: isCorrect,
        selectedValues: selectedValues,
      };

      if (isCorrect && !wasCorrect) {
        this.correctQuizzes++;
      } else if (!isCorrect && wasCorrect) {
        this.correctQuizzes--;
      }

      this.saveToStorage();
      this.updateDisplay();
    },

    wasPreviouslyCorrect: function (quizId) {
      return this.quizzes[quizId] && this.quizzes[quizId].correct;
    },

    resetQuiz: function (quizId) {
      if (this.quizzes[quizId]) {
        if (this.quizzes[quizId].correct) {
          this.correctQuizzes--;
        }
        this.answeredQuizzes--;
        delete this.quizzes[quizId];
        this.saveToStorage();
        this.updateDisplay();
      }
    },

    resetAllQuiz: function () {
      this.quizzes = {};
      this.answeredQuizzes = 0;
      this.correctQuizzes = 0;
      this.saveToStorage();
      this.updateDisplay();

      // Reset all quiz forms on the page
      document.querySelectorAll(".quiz").forEach((quiz) => {
        const form = quiz.querySelector("form");
        const fieldset = form.querySelector("fieldset");
        const submitButton = form.querySelector('button[type="submit"]');
        const resetButton = form.querySelector(".quiz-reset-button");
        const feedbackDiv = form.querySelector(".quiz-feedback");
        const section = quiz.querySelector("section");

        // Clear all selections
        const allInputs = fieldset.querySelectorAll('input[name="answer"]');
        allInputs.forEach((input) => {
          input.checked = false;
          input.disabled = false;
        });

        // Reset colors
        resetFieldset(fieldset);

        // Hide content section
        if (section) {
          section.classList.add("hidden");
        }

        // Hide feedback message
        feedbackDiv.classList.add("hidden");
        feedbackDiv.classList.remove("correct", "incorrect");
        feedbackDiv.textContent = "";

        // Show submit button, hide reset button
        if (submitButton) {
          submitButton.disabled = false;
          submitButton.classList.remove("hidden");
        }
        if (resetButton) {
          resetButton.classList.add("hidden");
        }
      });
    },

    getProgress: function () {
      return {
        total: this.totalQuizzes,
        answered: this.answeredQuizzes,
        correct: this.correctQuizzes,
        percentage: this.totalQuizzes > 0 ? Math.round((this.answeredQuizzes / this.totalQuizzes) * 100) : 0,
        score: this.totalQuizzes > 0 ? Math.round((this.correctQuizzes / this.totalQuizzes) * 100) : 0,
      };
    },

    saveToStorage: function () {
      try {
        const pageKey = STORAGE_KEY_PREFIX + window.location.pathname;
        const data = JSON.stringify(this.quizzes);

        // Check size limit (50KB max to prevent quota issues)
        if (data.length > 50000) {
          console.warn("Quiz progress data exceeds size limit, not saving to localStorage");
          this.showStorageWarning("Quiz progress is too large to save");
          return;
        }

        localStorage.setItem(pageKey, data);
      } catch (e) {
        // Handle quota exceeded or localStorage disabled
        console.error("Failed to save quiz progress:", e);
        this.showStorageWarning(
          "Unable to save quiz progress. Your browser may have storage disabled or quota exceeded.",
        );
      }
    },

    loadFromStorage: function () {
      try {
        const pageKey = STORAGE_KEY_PREFIX + window.location.pathname;
        const stored = localStorage.getItem(pageKey);

        if (stored) {
          // Validate size before parsing (50KB max)
          if (stored.length > 50000) {
            console.warn("Stored quiz data exceeds size limit, clearing corrupted data");
            localStorage.removeItem(pageKey);
            return;
          }

          const parsed = JSON.parse(stored);

          // Validate structure: should be an object
          if (typeof parsed !== "object" || parsed === null || Array.isArray(parsed)) {
            console.warn("Invalid quiz data structure, clearing corrupted data");
            localStorage.removeItem(pageKey);
            return;
          }

          this.quizzes = parsed;

          // Recalculate counts and validate quiz data structure
          this.answeredQuizzes = 0;
          this.correctQuizzes = 0;
          for (let key in this.quizzes) {
            const quiz = this.quizzes[key];
            // Validate each quiz entry has expected structure
            if (typeof quiz !== "object" || typeof quiz.answered !== "boolean" || typeof quiz.correct !== "boolean") {
              console.warn("Invalid quiz entry structure, clearing corrupted data");
              this.quizzes = {};
              localStorage.removeItem(pageKey);
              return;
            }

            if (quiz.answered) {
              this.answeredQuizzes++;
            }
            if (quiz.correct) {
              this.correctQuizzes++;
            }
          }
        }
      } catch (e) {
        // Handle parsing errors or localStorage unavailable
        console.error("Failed to load quiz progress:", e);
        const pageKey = STORAGE_KEY_PREFIX + window.location.pathname;
        try {
          localStorage.removeItem(pageKey); // Clear corrupted data
        } catch (cleanupError) {
          // localStorage might be completely unavailable
        }
      }
    },

    updateDisplay: function () {
      const progress = this.getProgress();
      const wasComplete = this.wasCompleted;
      const isComplete = progress.answered === progress.total && progress.total > 0;

      // Dispatch custom event for sidebar/other UI components
      window.dispatchEvent(
        new CustomEvent("quizProgressUpdate", {
          detail: progress,
        }),
      );
      // Update sidebar if it exists
      this.updateSidebar();
      // Update results div if it exists
      this.updateResultsDiv(progress, isComplete, wasComplete);

      // Track completion state
      this.wasCompleted = isComplete;
    },

    updateResultsDiv: function (progress, isComplete, wasComplete) {
      const resultsDiv = document.getElementById("quiz-results");
      if (!resultsDiv) return;

      // Update progress section
      const answeredEl = resultsDiv.querySelector(".quiz-results-answered");
      const totalEl = resultsDiv.querySelector(".quiz-results-total");
      const percentageEl = resultsDiv.querySelector(".quiz-results-percentage");
      const correctEl = resultsDiv.querySelector(".quiz-results-correct");

      if (answeredEl) answeredEl.textContent = progress.answered;
      if (totalEl) totalEl.textContent = progress.total;
      if (percentageEl) percentageEl.textContent = progress.percentage + "%";
      if (correctEl) correctEl.textContent = progress.correct;

      // Handle completion state
      const progressSection = resultsDiv.querySelector(".quiz-results-progress");
      const completeSection = resultsDiv.querySelector(".quiz-results-complete");

      if (isComplete) {
        // Hide progress, show complete
        if (progressSection) progressSection.classList.add("hidden");
        if (completeSection) {
          completeSection.classList.remove("hidden");

          // Update score display
          const scoreValue = resultsDiv.querySelector(".quiz-results-score-value");
          const scoreMessage = resultsDiv.querySelector(".quiz-results-message");

          if (scoreValue) {
            scoreValue.textContent = progress.score + "%";

            // Remove all score classes
            scoreValue.classList.remove(
              "quiz-results-score-excellent",
              "quiz-results-score-good",
              "quiz-results-score-average",
              "quiz-results-score-poor",
              "quiz-results-score-fail",
            );

            // Add appropriate score class and message
            let message = "";
            if (progress.score >= 90) {
              scoreValue.classList.add("quiz-results-score-excellent");
              message = t("Outstanding! You aced it!");
            } else if (progress.score >= 75) {
              scoreValue.classList.add("quiz-results-score-good");
              message = t("Great job! You really know your stuff!");
            } else if (progress.score >= 60) {
              scoreValue.classList.add("quiz-results-score-average");
              message = t("Good effort! Keep learning!");
            } else if (progress.score >= 40) {
              scoreValue.classList.add("quiz-results-score-poor");
              message = t("Not bad, but there's room for improvement!");
            } else {
              scoreValue.classList.add("quiz-results-score-fail");
              message = t("Better luck next time! Keep trying!");
            }

            if (scoreMessage) scoreMessage.textContent = message;
          }

          // Trigger confetti and scroll on first completion
          if (!wasComplete) {
            // Scroll to results div
            resultsDiv.scrollIntoView({ behavior: "smooth", block: "center" });

            // Fire confetti if enabled and score is good
            if (jsConfetti && progress.score >= 10) {
              setTimeout(() => {
                jsConfetti.addConfetti();
              }, 500);
            }
          }
        }
      } else {
        // Show progress, hide complete
        if (progressSection) progressSection.classList.remove("hidden");
        if (completeSection) completeSection.classList.add("hidden");
      }
    },

    updateSidebar: function () {
      // Update both desktop and mobile sidebars
      const sidebars = [
        document.getElementById("quiz-progress-sidebar"),
        document.getElementById("quiz-progress-mobile"),
      ];

      sidebars.forEach((sidebar) => {
        if (sidebar) {
          const progress = this.getProgress();

          // Update answered count
          const answeredEl = sidebar.querySelector(".quiz-progress-answered");
          if (answeredEl) {
            answeredEl.textContent = progress.answered;
          }

          // Update answered percentage - desktop only
          const answeredPercentageEl = sidebar.querySelector(".quiz-progress-answered-percentage");
          if (answeredPercentageEl && sidebar.id == "quiz-progress-sidebar") {
            answeredPercentageEl.textContent = progress.percentage + "%";
          }

          // Update all .quiz-progress-total elements
          const totalElements = sidebar.querySelectorAll(".quiz-progress-total");
          totalElements.forEach((el) => {
            el.textContent = progress.total;
          });

          // Update correct count
          const scoreEl = sidebar.querySelector(".quiz-progress-score");
          if (scoreEl) {
            scoreEl.textContent = progress.correct;
          }

          // Update correct denominator (answered count)
          const scoreTotalEl = sidebar.querySelector(".quiz-progress-score-total");
          if (scoreTotalEl) {
            scoreTotalEl.textContent = progress.answered;
          }

          // Update correct percentage (based on answered quizzes, not total) - desktop only
          const scorePercentageEl = sidebar.querySelector(".quiz-progress-score-percentage");
          if (scorePercentageEl && sidebar.id == "quiz-progress-sidebar") {
            const scorePercentage =
              progress.answered > 0 ? Math.round((progress.correct / progress.answered) * 100) : 0;
            scorePercentageEl.textContent = scorePercentage + "%";
          }

          // Update progress bars (incorrect and correct)
          const correctBar = sidebar.querySelector(".quiz-progress-bar-correct");
          const incorrectBar = sidebar.querySelector(".quiz-progress-bar-incorrect");

          if (correctBar && incorrectBar) {
            const incorrectCount = progress.answered - progress.correct;
            const correctPercentage = progress.total > 0 ? (progress.correct / progress.total) * 100 : 0;
            const incorrectPercentage = progress.total > 0 ? (incorrectCount / progress.total) * 100 : 0;

            incorrectBar.style.width = incorrectPercentage + "%";
            correctBar.style.width = correctPercentage + "%";
          }
        }
      });
    },

    createSidebar: function () {
      // Check if progress tracking is enabled
      const showProgress = window.mkdocsQuizConfig && window.mkdocsQuizConfig.showProgress !== false;

      // Only show sidebar if progress tracking is enabled and there are quizzes
      if (!showProgress || this.totalQuizzes === 0) {
        return;
      }

      // Show both desktop and mobile sidebars
      const desktopSidebar = document.getElementById("quiz-progress-sidebar");
      const mobileSidebar = document.getElementById("quiz-progress-mobile");

      if (desktopSidebar) {
        desktopSidebar.style.display = "";
      }
      if (mobileSidebar) {
        mobileSidebar.style.display = "";
      }

      // Initialize reset button event listeners
      const resetLinks = document.querySelectorAll(".quiz-reset-all-link");
      resetLinks.forEach((resetLink) => {
        const handler = (e) => {
          e.preventDefault();
          if (confirm(t("Are you sure you want to reset the quiz? This will clear your progress."))) {
            quizTracker.resetAllQuiz();
          }
        };
        addTrackedEventListener(resetLink, "click", handler);
      });

      // Update the sidebar with initial values
      this.updateSidebar();
    },

    showStorageWarning: function (message) {
      // Show a warning banner in the progress tracker if it exists
      const progressSidebar = document.getElementById("quiz-progress-sidebar");
      if (progressSidebar) {
        // Check if warning already exists
        let warningEl = progressSidebar.querySelector(".quiz-storage-warning");
        if (!warningEl) {
          warningEl = document.createElement("div");
          warningEl.className = "quiz-storage-warning";
          warningEl.style.cssText =
            "background: #fff3cd; color: #856404; padding: 8px; margin: 8px 0; border-radius: 4px; font-size: 12px; border: 1px solid #ffeaa7;";
          progressSidebar.insertBefore(warningEl, progressSidebar.firstChild);
        }
        warningEl.textContent = message;
      }
    },
  };

  // Translate template elements with data-quiz-translate attributes
  function translateTemplateElements() {
    document.querySelectorAll("[data-quiz-translate]").forEach((element) => {
      const key = element.getAttribute("data-quiz-translate");
      if (key) {
        element.textContent = t(key);
      }
    });
  }

  // Initialize results div reset button
  function initializeResultsDiv() {
    const resultsDiv = document.getElementById("quiz-results");
    if (!resultsDiv) return;

    const resetButton = resultsDiv.querySelector(".quiz-results-reset");
    if (resetButton) {
      const handler = () => {
        if (confirm(t("Are you sure you want to reset the quiz? This will clear your progress."))) {
          quizTracker.resetAllQuiz();
        }
      };
      addTrackedEventListener(resetButton, "click", handler);
    }
  }

  // Initialize intro reset buttons
  function initializeIntroResetButtons() {
    const introResetButtons = document.querySelectorAll(".quiz-intro-reset");
    introResetButtons.forEach((button) => {
      const handler = () => {
        if (confirm(t("Are you sure you want to reset the quiz? This will clear your progress."))) {
          quizTracker.resetAllQuiz();
        }
      };
      addTrackedEventListener(button, "click", handler);
    });
  }

  // Shuffle an array using Fisher-Yates algorithm
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // Shuffle the answer elements in a fieldset
  function shuffleAnswers(fieldset) {
    const answerDivs = Array.from(fieldset.querySelectorAll(":scope > div"));
    if (answerDivs.length <= 1) return;

    // Shuffle the array of elements
    shuffleArray(answerDivs);

    // Re-append elements in shuffled order
    answerDivs.forEach((div) => fieldset.appendChild(div));
  }

  // Initialize all quiz elements on the page
  function initializeQuizzes() {
    document.querySelectorAll(".quiz").forEach((quiz) => {
      let form = quiz.querySelector("form");
      let fieldset = form.querySelector("fieldset");
      let submitButton = form.querySelector('button[type="submit"]');
      let feedbackDiv = form.querySelector(".quiz-feedback");

      // Shuffle answers if enabled (before any state restoration)
      if (quiz.hasAttribute("data-shuffle-answers")) {
        shuffleAnswers(fieldset);
      }

      // Get quiz ID from the quiz div itself
      const quizId = quiz.id;

      // Prevent anchor link from triggering page navigation/reload
      const headerLink = quiz.querySelector(".quiz-header-link");
      if (headerLink) {
        const handler = (e) => {
          // Let the browser handle the anchor navigation normally
          // This prevents Material for MkDocs from intercepting it as a page navigation
          e.stopPropagation();
        };
        addTrackedEventListener(headerLink, "click", handler);
      }

      // Create reset button (initially hidden)
      let resetButton = document.createElement("button");
      resetButton.type = "button";
      resetButton.className = "quiz-button quiz-reset-button hidden";
      resetButton.textContent = t("Try Again");
      if (submitButton) {
        submitButton.parentNode.insertBefore(resetButton, submitButton.nextSibling);
      } else {
        form.appendChild(resetButton);
      }

      // Restore quiz state from localStorage if available
      if (quizId && quizTracker.quizzes[quizId]) {
        const savedState = quizTracker.quizzes[quizId];
        const section = quiz.querySelector("section");
        const allAnswers = fieldset.querySelectorAll('input[name="answer"]');
        const correctAnswers = fieldset.querySelectorAll('input[name="answer"][correct]');

        if (savedState.answered) {
          // Restore selected answers based on saved values
          if (savedState.selectedValues && savedState.selectedValues.length > 0) {
            allAnswers.forEach((input) => {
              if (savedState.selectedValues.includes(input.value)) {
                input.checked = true;
              }
            });
          }

          if (savedState.correct) {
            // Show the content section
            section.classList.remove("hidden");

            // Only mark the correct answers in green (don't highlight wrong answers)
            allAnswers.forEach((input) => {
              if (input.hasAttribute("correct")) {
                input.parentElement.classList.add("correct");
              }
            });

            // Show correct feedback
            feedbackDiv.classList.remove("hidden", "incorrect");
            feedbackDiv.classList.add("correct");
            feedbackDiv.textContent = t("Correct answer!");

            // Disable inputs if disable-after-submit is enabled
            if (quiz.hasAttribute("data-disable-after-submit")) {
              allAnswers.forEach((input) => {
                input.disabled = true;
              });
              if (submitButton) {
                submitButton.disabled = true;
              }
              resetButton.classList.add("hidden");
            } else {
              // Show reset button, hide submit button
              resetButton.classList.remove("hidden");
              if (submitButton) {
                submitButton.classList.add("hidden");
              }
            }
          } else {
            // Restore incorrect answer state
            const selectedInputs = Array.from(allAnswers).filter((input) =>
              savedState.selectedValues.includes(input.value),
            );

            // Show the content section for incorrect answers too
            section.classList.remove("hidden");

            // Mark selected answers
            selectedInputs.forEach((input) => {
              if (input.hasAttribute("correct")) {
                input.parentElement.classList.add("correct");
              } else {
                input.parentElement.classList.add("wrong");
              }
            });

            // Show correct answers if show-correct is enabled
            if (quiz.hasAttribute("data-show-correct")) {
              correctAnswers.forEach((input) => {
                input.parentElement.classList.add("correct");
              });
            }

            // Show incorrect feedback
            feedbackDiv.classList.remove("hidden", "correct");
            feedbackDiv.classList.add("incorrect");
            const canRetry = !quiz.hasAttribute("data-disable-after-submit");
            feedbackDiv.textContent = canRetry ? t("Incorrect answer. Please try again.") : t("Incorrect answer.");

            // Disable inputs if disable-after-submit is enabled
            if (quiz.hasAttribute("data-disable-after-submit")) {
              allAnswers.forEach((input) => {
                input.disabled = true;
              });
              if (submitButton) {
                submitButton.disabled = true;
              }
              resetButton.classList.add("hidden");
            } else {
              // Show reset button, hide submit button
              resetButton.classList.remove("hidden");
              if (submitButton) {
                submitButton.classList.add("hidden");
              }
            }
          }
        }
      }

      // Auto-submit on radio button change if enabled
      if (quiz.hasAttribute("data-auto-submit")) {
        let radioButtons = fieldset.querySelectorAll('input[type="radio"]');
        radioButtons.forEach((radio) => {
          const handler = (e) => {
            // Prevent any default behavior that might cause page scroll
            e.preventDefault();
            // Trigger form submission with a properly configured event
            // cancelable: true allows preventDefault to work
            // bubbles: true ensures proper event propagation
            form.dispatchEvent(new Event("submit", { cancelable: true, bubbles: true }));
          };
          addTrackedEventListener(radio, "change", handler);
        });
      }

      // Reset button handler
      const resetHandler = () => {
        // Clear all selections
        const allInputs = fieldset.querySelectorAll('input[name="answer"]');
        allInputs.forEach((input) => {
          input.checked = false;
          input.disabled = false;
        });
        // Reset colors
        resetFieldset(fieldset);
        // Hide content section
        let section = quiz.querySelector("section");
        section.classList.add("hidden");
        // Hide feedback message
        feedbackDiv.classList.add("hidden");
        feedbackDiv.classList.remove("correct", "incorrect");
        feedbackDiv.textContent = "";
        // Show submit button, hide reset button
        if (submitButton) {
          submitButton.disabled = false;
          submitButton.classList.remove("hidden");
        }
        resetButton.classList.add("hidden");
        // Update tracker
        if (quizId) {
          quizTracker.resetQuiz(quizId);
        }
      };
      addTrackedEventListener(resetButton, "click", resetHandler);

      const submitHandler = (event) => {
        // Prevent default form submission behavior
        event.preventDefault();
        // Stop propagation to prevent Material for MkDocs instant navigation from intercepting
        event.stopPropagation();
        let selectedAnswers = form.querySelectorAll('input[name="answer"]:checked');
        let correctAnswers = fieldset.querySelectorAll('input[name="answer"][correct]');
        // Check if all correct answers are selected
        let is_correct = selectedAnswers.length === correctAnswers.length;
        Array.from(selectedAnswers).forEach((answer) => {
          if (!answer.hasAttribute("correct")) {
            is_correct = false;
          }
        });
        let section = quiz.querySelector("section");
        // Always show the content section after submission
        section.classList.remove("hidden");

        if (is_correct) {
          resetFieldset(fieldset);
          // Only mark the correct answers in green (don't highlight wrong answers)
          const allAnswers = fieldset.querySelectorAll('input[name="answer"]');
          allAnswers.forEach((answer) => {
            if (answer.hasAttribute("correct")) {
              answer.parentElement.classList.add("correct");
            }
          });
          // Show correct feedback
          feedbackDiv.classList.remove("hidden", "incorrect");
          feedbackDiv.classList.add("correct");
          feedbackDiv.textContent = t("Correct answer!");
        } else {
          resetFieldset(fieldset);
          // Mark wrong fields with colors
          Array.from(selectedAnswers).forEach((answer) => {
            if (!answer.hasAttribute("correct")) {
              answer.parentElement.classList.add("wrong");
            } else {
              answer.parentElement.classList.add("correct");
            }
          });
          // If show-correct is enabled, also show all correct answers
          if (quiz.hasAttribute("data-show-correct")) {
            correctAnswers.forEach((answer) => {
              answer.parentElement.classList.add("correct");
            });
          }
          // Show incorrect feedback
          feedbackDiv.classList.remove("hidden", "correct");
          feedbackDiv.classList.add("incorrect");
          // Only show "Please try again" if the quiz is not disabled after submission
          const canRetry = !quiz.hasAttribute("data-disable-after-submit");
          feedbackDiv.textContent = canRetry ? t("Incorrect answer. Please try again.") : t("Incorrect answer.");
        }

        // Update tracker
        if (quizId) {
          // Get selected values to save
          const selectedValues = Array.from(selectedAnswers).map((input) => input.value);
          quizTracker.markQuiz(quizId, is_correct, selectedValues);
        }

        // Disable quiz after submission if option is enabled
        if (quiz.hasAttribute("data-disable-after-submit")) {
          const allInputs = fieldset.querySelectorAll('input[name="answer"]');
          allInputs.forEach((input) => {
            input.disabled = true;
          });
          if (submitButton) {
            submitButton.disabled = true;
          }
          // Hide reset button if disable-after-submit is enabled
          resetButton.classList.add("hidden");
        } else {
          // Show reset button and hide submit button
          resetButton.classList.remove("hidden");
          if (submitButton) {
            submitButton.classList.add("hidden");
          }
        }
      };
      addTrackedEventListener(form, "submit", submitHandler);
    });
  }

  function resetFieldset(fieldset) {
    Array.from(fieldset.children).forEach((child) => {
      child.classList.remove("wrong", "correct");
    });
  }

  // Main initialization function that sets up everything on a page
  function initializePage() {
    // Initialize tracker
    quizTracker.init();

    // Translate template elements
    translateTemplateElements();

    // Reposition sidebar for Material theme TOC integration
    repositionSidebar();

    // Create sidebar
    quizTracker.createSidebar();

    // Initialize results div and intro buttons
    initializeResultsDiv();
    initializeIntroResetButtons();

    // Initialize all quiz elements
    initializeQuizzes();
  }

  // Run initialization when DOM is ready
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initializePage);
  } else {
    initializePage();
  }

  // Material for MkDocs instant navigation support
  // Cleanup and reinitialize when navigating between pages
  if (typeof document$ !== "undefined") {
    // Unsubscribe from any previous subscription to prevent duplicate handlers
    // This is needed because the script re-runs on each page navigation,
    // which would otherwise accumulate subscriptions
    if (window._mkdocsQuizSubscription) {
      window._mkdocsQuizSubscription.unsubscribe();
    }

    // Material theme with instant navigation is active
    window._mkdocsQuizSubscription = document$.subscribe(() => {
      cleanup(); // Remove old event listeners to prevent memory leaks
      // Reinitialize everything for the new page
      initializePage();
    });
  }
})(); // End of IIFE
</script>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="https://github.com/mr-bev/software-engineering-stage6-nsw/issues/new/?title=[Feedback]+Server-Side%20Programming%2C%20Authentication%20%26%20Template%20Engines+-+/web_development/server_side_programming_authentication_template_engines/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../client_side_security_user_experience/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Client-Side Security &amp; User Experience">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Client-Side Security & User Experience
              </div>
            </div>
          </a>
        
        
          
          <a href="../database_integration_sql_security/" class="md-footer__link md-footer__link--next" aria-label="Next: Database Integration &amp; SQL Security">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Database Integration & SQL Security
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024-26 <a href="https://github.com/mr-bev" target="_blank" rel="noopener">Aaron Beverley</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognise your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.footer", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="../../javascripts/feedback.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>